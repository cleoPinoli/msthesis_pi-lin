\section{Agda Formalization}
\label{sec:formalization}

\begin{code}[hide]%
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Bool}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{Bool}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{true}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{false}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{if\AgdaUnderscore{}then\AgdaUnderscore{}else\AgdaUnderscore{}}}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Product}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}√ó\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{\AgdaUnderscore{},\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{‚àÉ}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{‚àÉ-syntax}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Relation.Binary.PropositionalEquality}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaDatatype{\AgdaUnderscore{}‚â°\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{cong}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{cong‚ÇÇ}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.List.Base}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{List}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{\AgdaUnderscore{}‚à∑\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{[\AgdaUnderscore{}]}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}++\AgdaUnderscore{}}}\AgdaSymbol{)}\<%
\end{code}

\subsection{Type Representation}
\label{sec:type-agda}

The representation of types is standard, with one constructor for each of the
forms described in \Cref{sec:calculus}.

\begin{code}%
\>[0]\AgdaKeyword{data}\AgdaSpace{}%
\AgdaDatatype{Type}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPrimitive{Set}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaInductiveConstructor{ùüò}\AgdaSpace{}%
\AgdaInductiveConstructor{ùüô}\AgdaSpace{}%
\AgdaInductiveConstructor{‚ä•}\AgdaSpace{}%
\AgdaInductiveConstructor{‚ä§}%
\>[19]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Type}\<%
\\
%
\>[2]\AgdaInductiveConstructor{¬°}\AgdaSpace{}%
\AgdaInductiveConstructor{¬ø}%
\>[19]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Type}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{Type}\<%
\\
%
\>[2]\AgdaOperator{\AgdaInductiveConstructor{\AgdaUnderscore{}\&\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{\AgdaUnderscore{}‚äï\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{\AgdaUnderscore{}‚äó\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{\AgdaUnderscore{}‚Öã\AgdaUnderscore{}}}%
\>[19]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Type}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{Type}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{Type}\<%
\end{code}

The notion of duality is formalized as a \emph{relation} \AgdaDatatype{Dual}
such that $\AgdaDatatype{Dual}~A~B$ holds if and only if $A = \dual{B}$.

\begin{code}%
\>[0]\AgdaKeyword{data}\AgdaSpace{}%
\AgdaDatatype{Dual}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Type}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{Type}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaPrimitive{Set}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaInductiveConstructor{d-ùüò-‚ä§}%
\>[9]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Dual}\AgdaSpace{}%
\AgdaInductiveConstructor{ùüò}\AgdaSpace{}%
\AgdaInductiveConstructor{‚ä§}\<%
\\
%
\>[2]\AgdaInductiveConstructor{d-‚ä§-ùüò}%
\>[9]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Dual}\AgdaSpace{}%
\AgdaInductiveConstructor{‚ä§}\AgdaSpace{}%
\AgdaInductiveConstructor{ùüò}\<%
\\
%
\>[2]\AgdaInductiveConstructor{d-ùüô-‚ä•}%
\>[9]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Dual}\AgdaSpace{}%
\AgdaInductiveConstructor{ùüô}\AgdaSpace{}%
\AgdaInductiveConstructor{‚ä•}\<%
\\
%
\>[2]\AgdaInductiveConstructor{d-‚ä•-ùüô}%
\>[9]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Dual}\AgdaSpace{}%
\AgdaInductiveConstructor{‚ä•}\AgdaSpace{}%
\AgdaInductiveConstructor{ùüô}\<%
\\
%
\>[2]\AgdaInductiveConstructor{d-!-?}%
\>[9]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{‚àÄ\{}\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{B}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{Dual}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{Dual}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{¬°}\AgdaSpace{}%
\AgdaBound{A}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{¬ø}\AgdaSpace{}%
\AgdaBound{B}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaInductiveConstructor{d-?-!}%
\>[9]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{‚àÄ\{}\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{B}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{Dual}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{Dual}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{¬ø}\AgdaSpace{}%
\AgdaBound{A}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{¬°}\AgdaSpace{}%
\AgdaBound{B}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaInductiveConstructor{d-\&-‚äï}%
\>[9]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{‚àÄ\{}\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaBound{A‚Ä≤}\AgdaSpace{}%
\AgdaBound{B‚Ä≤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{Dual}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{A‚Ä≤}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{Dual}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaBound{B‚Ä≤}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{Dual}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{\&}}\AgdaSpace{}%
\AgdaBound{B}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{A‚Ä≤}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚äï}}\AgdaSpace{}%
\AgdaBound{B‚Ä≤}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaInductiveConstructor{d-‚äï-\&}%
\>[9]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{‚àÄ\{}\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaBound{A‚Ä≤}\AgdaSpace{}%
\AgdaBound{B‚Ä≤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{Dual}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{A‚Ä≤}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{Dual}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaBound{B‚Ä≤}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{Dual}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚äï}}\AgdaSpace{}%
\AgdaBound{B}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{A‚Ä≤}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{\&}}\AgdaSpace{}%
\AgdaBound{B‚Ä≤}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaInductiveConstructor{d-‚äó-‚Öã}%
\>[9]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{‚àÄ\{}\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaBound{A‚Ä≤}\AgdaSpace{}%
\AgdaBound{B‚Ä≤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{Dual}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{A‚Ä≤}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{Dual}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaBound{B‚Ä≤}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{Dual}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚äó}}\AgdaSpace{}%
\AgdaBound{B}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{A‚Ä≤}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚Öã}}\AgdaSpace{}%
\AgdaBound{B‚Ä≤}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaInductiveConstructor{d-‚Öã-‚äó}%
\>[9]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{‚àÄ\{}\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaBound{A‚Ä≤}\AgdaSpace{}%
\AgdaBound{B‚Ä≤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{Dual}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{A‚Ä≤}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{Dual}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaBound{B‚Ä≤}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{Dual}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚Öã}}\AgdaSpace{}%
\AgdaBound{B}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{A‚Ä≤}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚äó}}\AgdaSpace{}%
\AgdaBound{B‚Ä≤}\AgdaSymbol{)}\<%
\end{code}

It is straightforward to prove that duality is a symmetric relation and that it
behaves as an involution. From this we prove that it acts as the function
$\dual\cdot$ defined in \Cref{sec:calculus}.

\begin{code}%
\>[0]\AgdaFunction{dual-symm}%
\>[12]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{‚àÄ\{}\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{B}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{Dual}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{Dual}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaBound{A}\<%
\\
\>[0]\AgdaFunction{dual-inv}%
\>[12]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{‚àÄ\{}\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaBound{C}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{Dual}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{Dual}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaBound{C}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚â°}}\AgdaSpace{}%
\AgdaBound{C}\<%
\\
\>[0]\AgdaFunction{dual-fun-r}%
\>[12]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{‚àÄ\{}\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaBound{C}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{Dual}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{Dual}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{C}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚â°}}\AgdaSpace{}%
\AgdaBound{C}\<%
\\
\>[0]\AgdaFunction{dual-fun-l}%
\>[12]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{‚àÄ\{}\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaBound{C}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{Dual}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{Dual}\AgdaSpace{}%
\AgdaBound{C}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚â°}}\AgdaSpace{}%
\AgdaBound{C}\<%
\end{code}
\begin{code}[hide]%
\>[0]\AgdaFunction{dual-symm}\AgdaSpace{}%
\AgdaInductiveConstructor{d-ùüò-‚ä§}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{d-‚ä§-ùüò}\<%
\\
\>[0]\AgdaFunction{dual-symm}\AgdaSpace{}%
\AgdaInductiveConstructor{d-‚ä§-ùüò}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{d-ùüò-‚ä§}\<%
\\
\>[0]\AgdaFunction{dual-symm}\AgdaSpace{}%
\AgdaInductiveConstructor{d-ùüô-‚ä•}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{d-‚ä•-ùüô}\<%
\\
\>[0]\AgdaFunction{dual-symm}\AgdaSpace{}%
\AgdaInductiveConstructor{d-‚ä•-ùüô}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{d-ùüô-‚ä•}\<%
\\
\>[0]\AgdaFunction{dual-symm}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{d-!-?}\AgdaSpace{}%
\AgdaBound{p}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{d-?-!}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{dual-symm}\AgdaSpace{}%
\AgdaBound{p}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{dual-symm}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{d-?-!}\AgdaSpace{}%
\AgdaBound{p}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{d-!-?}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{dual-symm}\AgdaSpace{}%
\AgdaBound{p}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{dual-symm}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{d-\&-‚äï}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{d-‚äï-\&}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{dual-symm}\AgdaSpace{}%
\AgdaBound{p}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{dual-symm}\AgdaSpace{}%
\AgdaBound{q}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{dual-symm}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{d-‚äï-\&}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{d-\&-‚äï}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{dual-symm}\AgdaSpace{}%
\AgdaBound{p}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{dual-symm}\AgdaSpace{}%
\AgdaBound{q}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{dual-symm}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{d-‚äó-‚Öã}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{d-‚Öã-‚äó}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{dual-symm}\AgdaSpace{}%
\AgdaBound{p}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{dual-symm}\AgdaSpace{}%
\AgdaBound{q}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{dual-symm}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{d-‚Öã-‚äó}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{d-‚äó-‚Öã}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{dual-symm}\AgdaSpace{}%
\AgdaBound{p}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{dual-symm}\AgdaSpace{}%
\AgdaBound{q}\AgdaSymbol{)}\<%
\end{code}

\begin{code}[hide]%
\>[0]\AgdaFunction{dual-inv}\AgdaSpace{}%
\AgdaInductiveConstructor{d-ùüò-‚ä§}\AgdaSpace{}%
\AgdaInductiveConstructor{d-‚ä§-ùüò}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\<%
\\
\>[0]\AgdaFunction{dual-inv}\AgdaSpace{}%
\AgdaInductiveConstructor{d-‚ä§-ùüò}\AgdaSpace{}%
\AgdaInductiveConstructor{d-ùüò-‚ä§}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\<%
\\
\>[0]\AgdaFunction{dual-inv}\AgdaSpace{}%
\AgdaInductiveConstructor{d-ùüô-‚ä•}\AgdaSpace{}%
\AgdaInductiveConstructor{d-‚ä•-ùüô}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\<%
\\
\>[0]\AgdaFunction{dual-inv}\AgdaSpace{}%
\AgdaInductiveConstructor{d-‚ä•-ùüô}\AgdaSpace{}%
\AgdaInductiveConstructor{d-ùüô-‚ä•}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\<%
\\
\>[0]\AgdaFunction{dual-inv}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{d-!-?}\AgdaSpace{}%
\AgdaBound{p}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{d-?-!}\AgdaSpace{}%
\AgdaBound{q}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{cong}\AgdaSpace{}%
\AgdaInductiveConstructor{¬°}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{dual-inv}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{dual-inv}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{d-?-!}\AgdaSpace{}%
\AgdaBound{p}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{d-!-?}\AgdaSpace{}%
\AgdaBound{q}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{cong}\AgdaSpace{}%
\AgdaInductiveConstructor{¬ø}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{dual-inv}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{dual-inv}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{d-\&-‚äï}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{d-‚äï-\&}\AgdaSpace{}%
\AgdaBound{r}\AgdaSpace{}%
\AgdaBound{s}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{cong‚ÇÇ}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{\AgdaUnderscore{}\&\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{dual-inv}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{r}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{dual-inv}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaBound{s}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{dual-inv}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{d-‚äï-\&}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{d-\&-‚äï}\AgdaSpace{}%
\AgdaBound{r}\AgdaSpace{}%
\AgdaBound{s}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{cong‚ÇÇ}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{\AgdaUnderscore{}‚äï\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{dual-inv}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{r}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{dual-inv}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaBound{s}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{dual-inv}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{d-‚äó-‚Öã}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{d-‚Öã-‚äó}\AgdaSpace{}%
\AgdaBound{r}\AgdaSpace{}%
\AgdaBound{s}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{cong‚ÇÇ}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{\AgdaUnderscore{}‚äó\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{dual-inv}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{r}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{dual-inv}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaBound{s}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{dual-inv}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{d-‚Öã-‚äó}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{d-‚äó-‚Öã}\AgdaSpace{}%
\AgdaBound{r}\AgdaSpace{}%
\AgdaBound{s}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{cong‚ÇÇ}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{\AgdaUnderscore{}‚Öã\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{dual-inv}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{r}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{dual-inv}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaBound{s}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{dual-fun-r}\AgdaSpace{}%
\AgdaBound{d}\AgdaSpace{}%
\AgdaBound{e}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{dual-inv}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{dual-symm}\AgdaSpace{}%
\AgdaBound{d}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{e}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{dual-fun-l}\AgdaSpace{}%
\AgdaBound{d}\AgdaSpace{}%
\AgdaBound{e}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{dual-inv}\AgdaSpace{}%
\AgdaBound{d}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{dual-symm}\AgdaSpace{}%
\AgdaBound{e}\AgdaSymbol{)}\<%
\end{code}

\subsection{Context Representation}
\label{sec:context-agda}

We are going to adopt a nameless representation of channels whereby a channel is
identified by its position in a typing context. This representation is akin to
using De Bruijn indices, except that the index, instead of being represented
explicitly by a natural number, is computable from the \emph{proof} that the
type of the channel belong to the typing context.
%
Typing contexts are represented using \emph{lists} of types, where the
(polymorphic) \AgdaDatatype{List} type is defined in Agda‚Ä≤s standard library.

\begin{code}%
\>[0]\AgdaFunction{Context}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPrimitive{Set}\<%
\\
\>[0]\AgdaFunction{Context}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaDatatype{List}\AgdaSpace{}%
\AgdaDatatype{Type}\<%
\end{code}

The most important operation concerning typing contexts is \emph{splitting}. The
splitting of $\ContextC$ into $\ContextD$ and $\ContextE$, which is denoted by
$\Splitting\ContextC\ContextD\ContextE$, represents the fact that $\ContextC$
contains all the types contained in $\ContextD$ and $\ContextE$, preserving both
their overall \emph{multiplicity} and also their relative \emph{order} within
$\ContextD$ and $\ContextE$. A \emph{proof} of
$\Splitting\ContextC\ContextD\ContextE$ shows how the types in $\ContextC$ are
distributed in $\ContextD$ and $\ContextE$ from left to right.

\begin{code}[hide]%
\>[0]\AgdaKeyword{infix}\AgdaSpace{}%
\AgdaNumber{4}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{\AgdaUnderscore{}‚âÉ\AgdaUnderscore{}+\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}‚âÉ\AgdaUnderscore{},\AgdaUnderscore{}}}\<%
\end{code}
\begin{code}%
\>[0]\AgdaKeyword{data}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{\AgdaUnderscore{}‚âÉ\AgdaUnderscore{}+\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Context}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaFunction{Context}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaFunction{Context}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaPrimitive{Set}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaInductiveConstructor{split-e}%
\>[11]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚âÉ}}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{+}}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\<%
\\
%
\>[2]\AgdaInductiveConstructor{split-l}%
\>[11]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{‚àÄ\{}\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSpace{}%
\AgdaBound{Œò}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚âÉ}}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{+}}\AgdaSpace{}%
\AgdaBound{Œò}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚âÉ}}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{+}}\AgdaSpace{}%
\AgdaBound{Œò}\<%
\\
%
\>[2]\AgdaInductiveConstructor{split-r}%
\>[11]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{‚àÄ\{}\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSpace{}%
\AgdaBound{Œò}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚âÉ}}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{+}}\AgdaSpace{}%
\AgdaBound{Œò}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚âÉ}}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{+}}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaBound{Œò}\<%
\end{code}

As an example, below is the splitting of the context $[A, B, C, D]$ into $[A,
D]$ and $[B, C]$. Note how the sequence of \AgdaInductiveConstructor{split-l}
and \AgdaInductiveConstructor{split-r} applications determines where each of the
types in $[A, B, C, D]$ ends up in $[A, D]$ and $[B, C]$.

\begin{code}[hide]%
\>[0]\AgdaKeyword{module}\AgdaSpace{}%
\AgdaModule{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{postulate}\AgdaSpace{}%
\AgdaPostulate{A}\AgdaSpace{}%
\AgdaPostulate{B}\AgdaSpace{}%
\AgdaPostulate{C}\AgdaSpace{}%
\AgdaPostulate{D}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Type}\<%
\end{code}
\begin{code}%
%
\>[2]\AgdaFunction{splitting-example}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaPostulate{A}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaPostulate{B}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaPostulate{C}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaPostulate{D}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚âÉ}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaPostulate{A}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaPostulate{D}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{+}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaPostulate{B}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaPostulate{C}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaFunction{splitting-example}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{split-l}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{split-r}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{split-r}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{split-l}\AgdaSpace{}%
\AgdaInductiveConstructor{split-e}\AgdaSymbol{)))}\<%
\end{code}

It is often the case that the context $\ContextD$ in a splitting
$\Splitting\ContextC\ContextD\ContextE$ is a singleton list $[A]$. For this
particular case, we introduce a dedicated notation that allows us to represent
this case in a more compact and readable way, as
$\SimpleSplitting\ContextC{A}\ContextE$.

\begin{code}%
\>[0]\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}‚âÉ\AgdaUnderscore{},\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Context}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{Type}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaFunction{Context}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaPrimitive{Set}\<%
\\
\>[0]\AgdaBound{Œì}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚âÉ}}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{,}}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚âÉ}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{[}}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{]}}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{+}}\AgdaSpace{}%
\AgdaBound{Œî}\<%
\end{code}

Context splitting enjoys a number of expected properties. In particular, it is
easy to see that splitting is commutative and that the empty context is both a
left and right unit of splitting.

\begin{code}%
\>[0]\AgdaFunction{+-comm}%
\>[10]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{‚àÄ\{}\AgdaBound{Œì}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSpace{}%
\AgdaBound{Œò}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚âÉ}}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{+}}\AgdaSpace{}%
\AgdaBound{Œò}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚âÉ}}\AgdaSpace{}%
\AgdaBound{Œò}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{+}}\AgdaSpace{}%
\AgdaBound{Œî}\<%
\\
\>[0]\AgdaFunction{+-unit-l}%
\>[10]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{‚àÄ\{}\AgdaBound{Œì}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚âÉ}}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{+}}\AgdaSpace{}%
\AgdaBound{Œì}\<%
\\
\>[0]\AgdaFunction{+-unit-r}%
\>[10]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{‚àÄ\{}\AgdaBound{Œì}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚âÉ}}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{+}}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\<%
\end{code}
\begin{code}[hide]%
\>[0]\AgdaFunction{+-comm}\AgdaSpace{}%
\AgdaInductiveConstructor{split-e}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{split-e}\<%
\\
\>[0]\AgdaFunction{+-comm}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{split-l}\AgdaSpace{}%
\AgdaBound{p}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{split-r}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{+-comm}\AgdaSpace{}%
\AgdaBound{p}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{+-comm}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{split-r}\AgdaSpace{}%
\AgdaBound{p}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{split-l}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{+-comm}\AgdaSpace{}%
\AgdaBound{p}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{+-unit-l}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaInductiveConstructor{[]}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{split-e}\<%
\\
\>[0]\AgdaFunction{+-unit-l}\AgdaSpace{}%
\AgdaSymbol{\{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}\}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{split-r}\AgdaSpace{}%
\AgdaFunction{+-unit-l}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{+-unit-r}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{+-comm}\AgdaSpace{}%
\AgdaFunction{+-unit-l}\<%
\end{code}

Context splitting is also associative in a sense that is made precise below. If
we write $\ContextD + \ContextE$ for some $\ContextC$ such that $Œì ‚âÉ Œî + Œò$, then
we can prove that $Œì_1 + (Œì_2 + Œì_3) = (Œì_1 + Œì_2) + Œì_3$.

\begin{code}%
\>[0]\AgdaFunction{+-assoc-r}%
\>[11]\AgdaSymbol{:}%
\>[573I]\AgdaSymbol{‚àÄ\{}\AgdaBound{Œì}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSpace{}%
\AgdaBound{Œò}\AgdaSpace{}%
\AgdaBound{Œî‚Ä≤}\AgdaSpace{}%
\AgdaBound{Œò‚Ä≤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚âÉ}}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{+}}\AgdaSpace{}%
\AgdaBound{Œò}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaBound{Œò}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚âÉ}}\AgdaSpace{}%
\AgdaBound{Œî‚Ä≤}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{+}}\AgdaSpace{}%
\AgdaBound{Œò‚Ä≤}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\<%
\\
\>[.][@{}l@{}]\<[573I]%
\>[13]\AgdaFunction{‚àÉ[}\AgdaSpace{}%
\AgdaBound{Œì‚Ä≤}\AgdaSpace{}%
\AgdaFunction{]}\AgdaSpace{}%
\AgdaBound{Œì‚Ä≤}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚âÉ}}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{+}}\AgdaSpace{}%
\AgdaBound{Œî‚Ä≤}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{√ó}}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚âÉ}}\AgdaSpace{}%
\AgdaBound{Œì‚Ä≤}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{+}}\AgdaSpace{}%
\AgdaBound{Œò‚Ä≤}\<%
\\
\>[0]\AgdaFunction{+-assoc-l}%
\>[11]\AgdaSymbol{:}%
\>[604I]\AgdaSymbol{‚àÄ\{}\AgdaBound{Œì}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSpace{}%
\AgdaBound{Œò}\AgdaSpace{}%
\AgdaBound{Œî‚Ä≤}\AgdaSpace{}%
\AgdaBound{Œò‚Ä≤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚âÉ}}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{+}}\AgdaSpace{}%
\AgdaBound{Œò}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚âÉ}}\AgdaSpace{}%
\AgdaBound{Œî‚Ä≤}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{+}}\AgdaSpace{}%
\AgdaBound{Œò‚Ä≤}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\<%
\\
\>[.][@{}l@{}]\<[604I]%
\>[13]\AgdaFunction{‚àÉ[}\AgdaSpace{}%
\AgdaBound{Œì‚Ä≤}\AgdaSpace{}%
\AgdaFunction{]}\AgdaSpace{}%
\AgdaBound{Œì‚Ä≤}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚âÉ}}\AgdaSpace{}%
\AgdaBound{Œò‚Ä≤}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{+}}\AgdaSpace{}%
\AgdaBound{Œò}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{√ó}}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚âÉ}}\AgdaSpace{}%
\AgdaBound{Œî‚Ä≤}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{+}}\AgdaSpace{}%
\AgdaBound{Œì‚Ä≤}\<%
\end{code}
\begin{code}[hide]%
\>[0]\AgdaFunction{+-assoc-r}\AgdaSpace{}%
\AgdaInductiveConstructor{split-e}\AgdaSpace{}%
\AgdaInductiveConstructor{split-e}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaInductiveConstructor{split-e}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaInductiveConstructor{split-e}\<%
\\
\>[0]\AgdaFunction{+-assoc-r}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{split-l}\AgdaSpace{}%
\AgdaBound{p}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaKeyword{with}\AgdaSpace{}%
\AgdaFunction{+-assoc-r}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\<%
\\
\>[0]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{p‚Ä≤}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{q‚Ä≤}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaInductiveConstructor{split-l}\AgdaSpace{}%
\AgdaBound{p‚Ä≤}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaInductiveConstructor{split-l}\AgdaSpace{}%
\AgdaBound{q‚Ä≤}\<%
\\
\>[0]\AgdaFunction{+-assoc-r}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{split-r}\AgdaSpace{}%
\AgdaBound{p}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{split-l}\AgdaSpace{}%
\AgdaBound{q}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaKeyword{with}\AgdaSpace{}%
\AgdaFunction{+-assoc-r}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\<%
\\
\>[0]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{p‚Ä≤}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{q‚Ä≤}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaInductiveConstructor{split-r}\AgdaSpace{}%
\AgdaBound{p‚Ä≤}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaInductiveConstructor{split-l}\AgdaSpace{}%
\AgdaBound{q‚Ä≤}\<%
\\
\>[0]\AgdaFunction{+-assoc-r}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{split-r}\AgdaSpace{}%
\AgdaBound{p}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{split-r}\AgdaSpace{}%
\AgdaBound{q}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaKeyword{with}\AgdaSpace{}%
\AgdaFunction{+-assoc-r}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\<%
\\
\>[0]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{p‚Ä≤}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{q‚Ä≤}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{p‚Ä≤}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaInductiveConstructor{split-r}\AgdaSpace{}%
\AgdaBound{q‚Ä≤}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{+-assoc-l}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaKeyword{with}\AgdaSpace{}%
\AgdaFunction{+-assoc-r}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{+-comm}\AgdaSpace{}%
\AgdaBound{p}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{+-comm}\AgdaSpace{}%
\AgdaBound{q}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{r}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{p‚Ä≤}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaFunction{+-comm}\AgdaSpace{}%
\AgdaBound{r}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaFunction{+-comm}\AgdaSpace{}%
\AgdaBound{p‚Ä≤}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{+-empty-l}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{‚àÄ\{}\AgdaBound{Œì}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚âÉ}}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{+}}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚â°}}\AgdaSpace{}%
\AgdaBound{Œî}\<%
\\
\>[0]\AgdaFunction{+-empty-l}\AgdaSpace{}%
\AgdaInductiveConstructor{split-e}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\<%
\\
\>[0]\AgdaFunction{+-empty-l}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{split-r}\AgdaSpace{}%
\AgdaBound{p}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{cong}\AgdaSpace{}%
\AgdaSymbol{(\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑\AgdaUnderscore{}}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{+-empty-l}\AgdaSpace{}%
\AgdaBound{p}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{+-sing-l}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{‚àÄ\{}\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{[}}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{]}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚âÉ}}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{,}}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚â°}}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{√ó}}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚â°}}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\<%
\\
\>[0]\AgdaFunction{+-sing-l}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{split-l}\AgdaSpace{}%
\AgdaInductiveConstructor{split-e}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\<%
\end{code}

\subsection{Context Permutations}
\label{sec:permutation-agda}

\begin{code}%
\>[0]\AgdaKeyword{data}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{\AgdaUnderscore{}\#\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Context}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaFunction{Context}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaPrimitive{Set}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaInductiveConstructor{\#refl}%
\>[9]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{‚àÄ\{}\AgdaBound{Œì}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{\#}}\AgdaSpace{}%
\AgdaBound{Œì}\<%
\\
%
\>[2]\AgdaInductiveConstructor{\#here}%
\>[9]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{‚àÄ\{}\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{\#}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaInductiveConstructor{\#next}%
\>[9]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{‚àÄ\{}\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{\#}}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{\#}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaInductiveConstructor{\#tran}%
\>[9]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{‚àÄ\{}\AgdaBound{Œì}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSpace{}%
\AgdaBound{Œò}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{\#}}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{\#}}\AgdaSpace{}%
\AgdaBound{Œò}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{\#}}\AgdaSpace{}%
\AgdaBound{Œò}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{\#sym}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{‚àÄ\{}\AgdaBound{Œì}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{\#}}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{\#}}\AgdaSpace{}%
\AgdaBound{Œì}\<%
\\
\>[0]\AgdaFunction{\#sym}\AgdaSpace{}%
\AgdaInductiveConstructor{\#refl}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{\#refl}\<%
\\
\>[0]\AgdaFunction{\#sym}\AgdaSpace{}%
\AgdaInductiveConstructor{\#here}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{\#here}\<%
\\
\>[0]\AgdaFunction{\#sym}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{\#next}\AgdaSpace{}%
\AgdaBound{œÄ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{\#next}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{\#sym}\AgdaSpace{}%
\AgdaBound{œÄ}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{\#sym}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{\#tran}\AgdaSpace{}%
\AgdaBound{œÄ}\AgdaSpace{}%
\AgdaBound{œÄ‚Ä≤}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{\#tran}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{\#sym}\AgdaSpace{}%
\AgdaBound{œÄ‚Ä≤}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{\#sym}\AgdaSpace{}%
\AgdaBound{œÄ}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{\#empty-inv}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{‚àÄ\{}\AgdaBound{Œì}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{\#}}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚â°}}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\<%
\\
\>[0]\AgdaFunction{\#empty-inv}\AgdaSpace{}%
\AgdaInductiveConstructor{\#refl}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\<%
\\
\>[0]\AgdaFunction{\#empty-inv}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{\#tran}\AgdaSpace{}%
\AgdaBound{œÄ}\AgdaSpace{}%
\AgdaBound{œÄ‚Ä≤}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaKeyword{rewrite}\AgdaSpace{}%
\AgdaFunction{\#empty-inv}\AgdaSpace{}%
\AgdaBound{œÄ}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaFunction{\#empty-inv}\AgdaSpace{}%
\AgdaBound{œÄ‚Ä≤}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{\#singleton-inv}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{‚àÄ\{}\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{[}}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{]}}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{\#}}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚â°}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{[}}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{]}}\<%
\\
\>[0]\AgdaFunction{\#singleton-inv}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{Œì}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaInductiveConstructor{\#refl}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\<%
\\
\>[0]\AgdaFunction{\#singleton-inv}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{Œì}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{\#next}\AgdaSpace{}%
\AgdaBound{œÄ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaKeyword{rewrite}\AgdaSpace{}%
\AgdaFunction{\#empty-inv}\AgdaSpace{}%
\AgdaBound{œÄ}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\<%
\\
\>[0]\AgdaFunction{\#singleton-inv}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{Œì}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{\#tran}\AgdaSpace{}%
\AgdaBound{œÄ}\AgdaSpace{}%
\AgdaBound{œÄ‚Ä≤}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaKeyword{rewrite}\AgdaSpace{}%
\AgdaFunction{\#singleton-inv}\AgdaSpace{}%
\AgdaBound{œÄ}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaFunction{\#singleton-inv}\AgdaSpace{}%
\AgdaBound{œÄ‚Ä≤}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{\#rot}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{‚àÄ\{}\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaBound{C}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaBound{C}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{\#}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{C}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{\#rot}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{\#tran}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{\#next}\AgdaSpace{}%
\AgdaInductiveConstructor{\#here}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaInductiveConstructor{\#here}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{\#cons}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{‚àÄ\{}\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚âÉ}}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{,}}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{\#}}\AgdaSpace{}%
\AgdaBound{Œì}\<%
\\
\>[0]\AgdaFunction{\#cons}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{split-l}\AgdaSpace{}%
\AgdaBound{p}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaKeyword{with}\AgdaSpace{}%
\AgdaFunction{+-empty-l}\AgdaSpace{}%
\AgdaBound{p}\<%
\\
\>[0]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{\#refl}\<%
\\
\>[0]\AgdaFunction{\#cons}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{split-r}\AgdaSpace{}%
\AgdaBound{p}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{\#tran}\AgdaSpace{}%
\AgdaInductiveConstructor{\#here}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{\#next}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{\#cons}\AgdaSpace{}%
\AgdaBound{p}\AgdaSymbol{))}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{\#split}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{‚àÄ\{}\AgdaBound{Œì}\AgdaSpace{}%
\AgdaBound{Œì‚ÇÅ}\AgdaSpace{}%
\AgdaBound{Œì‚ÇÇ}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{\#}}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚âÉ}}\AgdaSpace{}%
\AgdaBound{Œì‚ÇÅ}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{+}}\AgdaSpace{}%
\AgdaBound{Œì‚ÇÇ}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaFunction{‚àÉ[}\AgdaSpace{}%
\AgdaBound{Œî‚ÇÅ}\AgdaSpace{}%
\AgdaFunction{]}\AgdaSpace{}%
\AgdaFunction{‚àÉ[}\AgdaSpace{}%
\AgdaBound{Œî‚ÇÇ}\AgdaSpace{}%
\AgdaFunction{]}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{Œî}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚âÉ}}\AgdaSpace{}%
\AgdaBound{Œî‚ÇÅ}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{+}}\AgdaSpace{}%
\AgdaBound{Œî‚ÇÇ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{√ó}}\AgdaSpace{}%
\AgdaBound{Œì‚ÇÅ}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{\#}}\AgdaSpace{}%
\AgdaBound{Œî‚ÇÅ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{√ó}}\AgdaSpace{}%
\AgdaBound{Œì‚ÇÇ}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{\#}}\AgdaSpace{}%
\AgdaBound{Œî‚ÇÇ}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{\#split}\AgdaSpace{}%
\AgdaInductiveConstructor{\#refl}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaInductiveConstructor{\#refl}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaInductiveConstructor{\#refl}\<%
\\
\>[0]\AgdaFunction{\#split}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{\#next}\AgdaSpace{}%
\AgdaBound{œÄ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{split-l}\AgdaSpace{}%
\AgdaBound{p}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaKeyword{with}\AgdaSpace{}%
\AgdaFunction{\#split}\AgdaSpace{}%
\AgdaBound{œÄ}\AgdaSpace{}%
\AgdaBound{p}\<%
\\
\>[0]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaBound{Œî‚ÇÅ}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{Œî‚ÇÇ}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{œÄ‚ÇÅ}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{œÄ‚ÇÇ}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaBound{Œî‚ÇÅ}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{Œî‚ÇÇ}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaInductiveConstructor{split-l}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaInductiveConstructor{\#next}\AgdaSpace{}%
\AgdaBound{œÄ‚ÇÅ}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{œÄ‚ÇÇ}\<%
\\
\>[0]\AgdaFunction{\#split}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{\#next}\AgdaSpace{}%
\AgdaBound{œÄ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{split-r}\AgdaSpace{}%
\AgdaBound{p}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaKeyword{with}\AgdaSpace{}%
\AgdaFunction{\#split}\AgdaSpace{}%
\AgdaBound{œÄ}\AgdaSpace{}%
\AgdaBound{p}\<%
\\
\>[0]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaBound{Œî‚ÇÅ}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{Œî‚ÇÇ}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{œÄ‚ÇÅ}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{œÄ‚ÇÇ}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{Œî‚ÇÅ}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaBound{Œî‚ÇÇ}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaInductiveConstructor{split-r}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{œÄ‚ÇÅ}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaInductiveConstructor{\#next}\AgdaSpace{}%
\AgdaBound{œÄ‚ÇÇ}\<%
\\
\>[0]\AgdaFunction{\#split}\AgdaSpace{}%
\AgdaInductiveConstructor{\#here}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{split-l}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{split-l}\AgdaSpace{}%
\AgdaBound{p}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaInductiveConstructor{split-l}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{split-l}\AgdaSpace{}%
\AgdaBound{p}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaInductiveConstructor{\#here}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaInductiveConstructor{\#refl}\<%
\\
\>[0]\AgdaFunction{\#split}\AgdaSpace{}%
\AgdaInductiveConstructor{\#here}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{split-l}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{split-r}\AgdaSpace{}%
\AgdaBound{p}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaInductiveConstructor{split-r}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{split-l}\AgdaSpace{}%
\AgdaBound{p}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaInductiveConstructor{\#refl}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaInductiveConstructor{\#refl}\<%
\\
\>[0]\AgdaFunction{\#split}\AgdaSpace{}%
\AgdaInductiveConstructor{\#here}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{split-r}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{split-l}\AgdaSpace{}%
\AgdaBound{p}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaInductiveConstructor{split-l}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{split-r}\AgdaSpace{}%
\AgdaBound{p}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaInductiveConstructor{\#refl}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaInductiveConstructor{\#refl}\<%
\\
\>[0]\AgdaFunction{\#split}\AgdaSpace{}%
\AgdaInductiveConstructor{\#here}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{split-r}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{split-r}\AgdaSpace{}%
\AgdaBound{p}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaInductiveConstructor{split-r}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{split-r}\AgdaSpace{}%
\AgdaBound{p}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaInductiveConstructor{\#refl}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaInductiveConstructor{\#here}\<%
\\
\>[0]\AgdaFunction{\#split}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{\#tran}\AgdaSpace{}%
\AgdaBound{œÄ}\AgdaSpace{}%
\AgdaBound{œÄ‚Ä≤}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaKeyword{with}\AgdaSpace{}%
\AgdaFunction{\#split}\AgdaSpace{}%
\AgdaBound{œÄ}\AgdaSpace{}%
\AgdaBound{p}\<%
\\
\>[0]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaBound{Œò‚ÇÅ}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{Œò‚ÇÇ}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{p‚Ä≤}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{œÄ‚ÇÅ}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{œÄ‚ÇÇ}\AgdaSpace{}%
\AgdaKeyword{with}\AgdaSpace{}%
\AgdaFunction{\#split}\AgdaSpace{}%
\AgdaBound{œÄ‚Ä≤}\AgdaSpace{}%
\AgdaBound{p‚Ä≤}\<%
\\
\>[0]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaBound{Œî‚ÇÅ}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{Œî‚ÇÇ}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{œÄ‚ÇÅ‚Ä≤}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{œÄ‚ÇÇ‚Ä≤}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{Œî‚ÇÅ}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{Œî‚ÇÇ}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaInductiveConstructor{\#tran}\AgdaSpace{}%
\AgdaBound{œÄ‚ÇÅ}\AgdaSpace{}%
\AgdaBound{œÄ‚ÇÅ‚Ä≤}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaInductiveConstructor{\#tran}\AgdaSpace{}%
\AgdaBound{œÄ‚ÇÇ}\AgdaSpace{}%
\AgdaBound{œÄ‚ÇÇ‚Ä≤}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{\#one+}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{‚àÄ\{}\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaBound{Œì‚Ä≤}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{\#}}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚âÉ}}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{,}}\AgdaSpace{}%
\AgdaBound{Œì‚Ä≤}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaFunction{‚àÉ[}\AgdaSpace{}%
\AgdaBound{Œî‚Ä≤}\AgdaSpace{}%
\AgdaFunction{]}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{Œî}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚âÉ}}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{,}}\AgdaSpace{}%
\AgdaBound{Œî‚Ä≤}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{√ó}}\AgdaSpace{}%
\AgdaBound{Œì‚Ä≤}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{\#}}\AgdaSpace{}%
\AgdaBound{Œî‚Ä≤}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{\#one+}\AgdaSpace{}%
\AgdaBound{œÄ}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaKeyword{with}\AgdaSpace{}%
\AgdaFunction{\#split}\AgdaSpace{}%
\AgdaBound{œÄ}\AgdaSpace{}%
\AgdaBound{p}\<%
\\
\>[0]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{œÄ‚ÇÅ}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{œÄ‚ÇÇ}\AgdaSpace{}%
\AgdaKeyword{rewrite}\AgdaSpace{}%
\AgdaFunction{\#singleton-inv}\AgdaSpace{}%
\AgdaBound{œÄ‚ÇÅ}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{œÄ‚ÇÇ}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{\#shift}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{‚àÄ\{}\AgdaBound{Œì}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{Œì}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{++}}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{\#}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{++}}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{\#shift}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaInductiveConstructor{[]}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{\#refl}\<%
\\
\>[0]\AgdaFunction{\#shift}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{\#tran}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{\#next}\AgdaSpace{}%
\AgdaFunction{\#shift}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaInductiveConstructor{\#here}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{+++\#}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{‚àÄ\{}\AgdaBound{Œì}\AgdaSpace{}%
\AgdaBound{Œì‚ÇÅ}\AgdaSpace{}%
\AgdaBound{Œì‚ÇÇ}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚âÉ}}\AgdaSpace{}%
\AgdaBound{Œì‚ÇÅ}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{+}}\AgdaSpace{}%
\AgdaBound{Œì‚ÇÇ}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{Œì‚ÇÅ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{++}}\AgdaSpace{}%
\AgdaBound{Œì‚ÇÇ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{\#}}\AgdaSpace{}%
\AgdaBound{Œì}\<%
\\
\>[0]\AgdaFunction{+++\#}\AgdaSpace{}%
\AgdaInductiveConstructor{split-e}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{\#refl}\<%
\\
\>[0]\AgdaFunction{+++\#}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{split-l}\AgdaSpace{}%
\AgdaBound{p}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{\#next}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{+++\#}\AgdaSpace{}%
\AgdaBound{p}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{+++\#}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{split-r}\AgdaSpace{}%
\AgdaBound{p}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{\#tran}\AgdaSpace{}%
\AgdaFunction{\#shift}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{\#next}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{+++\#}\AgdaSpace{}%
\AgdaBound{p}\AgdaSymbol{))}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{\#left}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{‚àÄ\{}\AgdaBound{Œì}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSpace{}%
\AgdaBound{Œò}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{\#}}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{Œò}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{++}}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{\#}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{Œò}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{++}}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{\#left}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{Œò}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{œÄ}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{œÄ}\<%
\\
\>[0]\AgdaFunction{\#left}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{Œò}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaBound{Œò}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{œÄ}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{\#next}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{\#left}\AgdaSpace{}%
\AgdaBound{œÄ}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{data}\AgdaSpace{}%
\AgdaDatatype{Un}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Context}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaPrimitive{Set}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaInductiveConstructor{un-[]}%
\>[9]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Un}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\<%
\\
%
\>[2]\AgdaInductiveConstructor{un-‚à∑}%
\>[9]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{‚àÄ\{}\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{Un}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{Un}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{¬ø}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{\#un}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{‚àÄ\{}\AgdaBound{Œì}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{\#}}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{Un}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{Un}\AgdaSpace{}%
\AgdaBound{Œî}\<%
\\
\>[0]\AgdaFunction{\#un}\AgdaSpace{}%
\AgdaInductiveConstructor{\#refl}\AgdaSpace{}%
\AgdaBound{un}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{un}\<%
\\
\>[0]\AgdaFunction{\#un}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{\#next}\AgdaSpace{}%
\AgdaBound{œÄ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{un-‚à∑}\AgdaSpace{}%
\AgdaBound{un}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{un-‚à∑}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{\#un}\AgdaSpace{}%
\AgdaBound{œÄ}\AgdaSpace{}%
\AgdaBound{un}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{\#un}\AgdaSpace{}%
\AgdaInductiveConstructor{\#here}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{un-‚à∑}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{un-‚à∑}\AgdaSpace{}%
\AgdaBound{un}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{un-‚à∑}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{un-‚à∑}\AgdaSpace{}%
\AgdaBound{un}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{\#un}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{\#tran}\AgdaSpace{}%
\AgdaBound{œÄ}\AgdaSpace{}%
\AgdaBound{œÄ‚Ä≤}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{un}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{\#un}\AgdaSpace{}%
\AgdaBound{œÄ‚Ä≤}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{\#un}\AgdaSpace{}%
\AgdaBound{œÄ}\AgdaSpace{}%
\AgdaBound{un}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{\#un+}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{‚àÄ\{}\AgdaBound{Œì}\AgdaSpace{}%
\AgdaBound{Œì‚ÇÅ}\AgdaSpace{}%
\AgdaBound{Œì‚ÇÇ}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚âÉ}}\AgdaSpace{}%
\AgdaBound{Œì‚ÇÅ}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{+}}\AgdaSpace{}%
\AgdaBound{Œì‚ÇÇ}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{Un}\AgdaSpace{}%
\AgdaBound{Œì‚ÇÅ}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{Un}\AgdaSpace{}%
\AgdaBound{Œì‚ÇÇ}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{Un}\AgdaSpace{}%
\AgdaBound{Œì}\<%
\\
\>[0]\AgdaFunction{\#un+}\AgdaSpace{}%
\AgdaInductiveConstructor{split-e}\AgdaSpace{}%
\AgdaInductiveConstructor{un-[]}\AgdaSpace{}%
\AgdaInductiveConstructor{un-[]}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{un-[]}\<%
\\
\>[0]\AgdaFunction{\#un+}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{split-l}\AgdaSpace{}%
\AgdaBound{p}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{un-‚à∑}\AgdaSpace{}%
\AgdaBound{un‚ÇÅ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{un‚ÇÇ}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{un-‚à∑}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{\#un+}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{un‚ÇÅ}\AgdaSpace{}%
\AgdaBound{un‚ÇÇ}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{\#un+}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{split-r}\AgdaSpace{}%
\AgdaBound{p}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{un‚ÇÅ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{un-‚à∑}\AgdaSpace{}%
\AgdaBound{un‚ÇÇ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{un-‚à∑}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{\#un+}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{un‚ÇÅ}\AgdaSpace{}%
\AgdaBound{un‚ÇÇ}\AgdaSymbol{)}\<%
\end{code}

\subsection{Process Representation}
\label{sec:process-agda}

CO-DE BRUIJN INDICES

We adopt an \emph{intrinsically typed} representation of processes, so that a
process is also a proof derivation showing that the process is well typed. This
choice increases the effort in the definition of the datatypes for processes and
their operational semantics, but it pays off in the rest of the formalization
for a number of reasons:

\begin{itemize}
\item channel names are encoded in the context splitting proofs occurring within
  processes, hence they do not need to be represented explicitly.
\item processes and typing rules are conflated in the same datatype, thus
  reducing the overall number of datatypes in the formalization;
\item the typing preservation results are embedded in the definition of the
  operational semantics of processes and do not need to be proved separately.
\end{itemize}

We now illustrate the definition of the \AgdaDatatype{Process} datatype and
describe each constructor in detail. The datatype is indexed by a typing
context:

\begin{AgdaAlign}
\begin{code}%
\>[0]\AgdaKeyword{data}\AgdaSpace{}%
\AgdaDatatype{Process}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Context}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaPrimitive{Set}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[3]\AgdaInductiveConstructor{link}%
\>[13]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{‚àÄ\{}\AgdaBound{Œì}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{B}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{d}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Dual}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{B}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{p}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚âÉ}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{[}}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{]}}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{+}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{[}}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{]}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{Process}\AgdaSpace{}%
\AgdaBound{Œì}\<%
\end{code}

A \AgdaInductiveConstructor{link} process is well typed in a typing context with
exactly two types $A$ and $B$ which must be related by duality. We use a proof
$p$ that $\Context \simeq [A] + [B]$ instead of requiring $\Context$ to be
simply $[A,B]$ so that it becomes straightforward to define \SLink using
\AgdaFunction{dual-symm} and \AgdaFunction{+-comm}.

\begin{code}%
%
\>[3]\AgdaInductiveConstructor{fail}%
\>[13]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{‚àÄ\{}\AgdaBound{Œì}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{p}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚âÉ}}\AgdaSpace{}%
\AgdaInductiveConstructor{‚ä§}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{,}}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{Process}\AgdaSpace{}%
\AgdaBound{Œì}\<%
\end{code}

A \AgdaInductiveConstructor{fail} process simply requires the presence of $\Top$
in the typing context.

\begin{code}%
%
\>[3]\AgdaInductiveConstructor{close}%
\>[13]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Process}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{[}}\AgdaSpace{}%
\AgdaInductiveConstructor{ùüô}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{]}}\<%
\end{code}

A \AgdaInductiveConstructor{close} process is well typed in the singleton
context $[\One]$.

\begin{code}%
%
\>[3]\AgdaInductiveConstructor{wait}%
\>[13]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{‚àÄ\{}\AgdaBound{Œì}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{p}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚âÉ}}\AgdaSpace{}%
\AgdaInductiveConstructor{‚ä•}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{,}}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{Process}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{Process}\AgdaSpace{}%
\AgdaBound{Œì}\<%
\end{code}

A \AgdaInductiveConstructor{wait} process is well typed in any context
$\ContextC$ that contains $\Bot$ and whose residual $\ContextD$ allows the
continuation to be well typed.

\begin{code}%
%
\>[3]\AgdaInductiveConstructor{select}%
\>[13]\AgdaSymbol{:}%
\>[1531I]\AgdaSymbol{‚àÄ\{}\AgdaBound{Œì}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{B}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Bool}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{p}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚âÉ}}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚äï}}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{,}}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\<%
\\
\>[.][@{}l@{}]\<[1531I]%
\>[15]\AgdaDatatype{Process}\AgdaSpace{}%
\AgdaSymbol{((}\AgdaOperator{\AgdaFunction{if}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{then}}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{else}}\AgdaSpace{}%
\AgdaBound{B}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{Process}\AgdaSpace{}%
\AgdaBound{Œì}\<%
\end{code}

We represent the tags $\InTag_1$ and $\InTag_2$ with Agda‚Ä≤s boolean values
\AgdaInductiveConstructor{true} and \AgdaInductiveConstructor{false}. In this
way we can use a single constructor \AgdaInductiveConstructor{select} for the
selections $\Select\x{\InTag_i}.P$. According to the semantics of \Calculus, the
channel on which the selection is performed is consumed and the continuation
process uses a fresh continuation channel. As a consequence, the type of the
continuation channel, which is either $A$ or $B$ depending on the value of the
tag $x$, is \emph{prepended} in front of the typing context used to type the
continuation process.

\begin{code}%
%
\>[3]\AgdaInductiveConstructor{case}%
\>[13]\AgdaSymbol{:}%
\>[1559I]\AgdaSymbol{‚àÄ\{}\AgdaBound{Œì}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{B}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{p}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚âÉ}}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{\&}}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{,}}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\<%
\\
\>[.][@{}l@{}]\<[1559I]%
\>[15]\AgdaDatatype{Process}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{Process}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{Process}\AgdaSpace{}%
\AgdaBound{Œì}\<%
\end{code}

A \AgdaInductiveConstructor{case} process has two possible continuations. Note
again that the continuation channel, which is received along with the tag, has
either type $A$ or type $B$ depending on the tag and its type is prepended to
the typing context of the continuation process since it is the newest channel.

\begin{code}%
%
\>[3]\AgdaInductiveConstructor{fork}%
\>[13]\AgdaSymbol{:}%
\>[1584I]\AgdaSymbol{‚àÄ\{}\AgdaBound{Œì}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSpace{}%
\AgdaBound{Œì‚ÇÅ}\AgdaSpace{}%
\AgdaBound{Œì‚ÇÇ}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{B}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{p}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚âÉ}}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚äó}}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{,}}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{q}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚âÉ}}\AgdaSpace{}%
\AgdaBound{Œì‚ÇÅ}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{+}}\AgdaSpace{}%
\AgdaBound{Œì‚ÇÇ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\<%
\\
\>[.][@{}l@{}]\<[1584I]%
\>[15]\AgdaDatatype{Process}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaBound{Œì‚ÇÅ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{Process}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaBound{Œì‚ÇÇ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{Process}\AgdaSpace{}%
\AgdaBound{Œì}\<%
\end{code}

A \AgdaInductiveConstructor{fork} process creates two fresh continuation
channels and spaws two continuation processes. Since context splitting is a
ternary relation, we need two splitting proofs $p$ and $q$ to isolate the type
$A \Ten B$ of channel on which the pair of continuation channels is sent and to
distribute the remaining channel across the two continuation processes.

\begin{code}%
%
\>[3]\AgdaInductiveConstructor{join}%
\>[13]\AgdaSymbol{:}%
\>[1618I]\AgdaSymbol{‚àÄ\{}\AgdaBound{Œì}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{B}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{p}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚âÉ}}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚Öã}}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{,}}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\<%
\\
\>[.][@{}l@{}]\<[1618I]%
\>[15]\AgdaDatatype{Process}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{Process}\AgdaSpace{}%
\AgdaBound{Œì}\<%
\end{code}

The \AgdaInductiveConstructor{join} process has a single continuation which uses
the pair of continuation channels received from a channel of type $A \Par B$.
Note that $B$ is prepended in front of $A$, somewhat implying that the second
continuation is bound \emph{after} the first even though, from a technical
standpoint, both continuations are bound simultaneously. We could have prepended
the types $A$ and $B$ also in the opposite order, provided that the reduction
rule \RFork (formalized in \Cref{sec:semantics-agda}) is suitably adjusted.

\begin{code}%
%
\>[3]\AgdaInductiveConstructor{server}%
\>[13]\AgdaSymbol{:}%
\>[1640I]\AgdaSymbol{‚àÄ\{}\AgdaBound{Œì}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSpace{}%
\AgdaBound{A}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{p}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚âÉ}}\AgdaSpace{}%
\AgdaInductiveConstructor{¬°}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{,}}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{un}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Un}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\<%
\\
\>[.][@{}l@{}]\<[1640I]%
\>[15]\AgdaDatatype{Process}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{Process}\AgdaSpace{}%
\AgdaBound{Œì}\<%
\end{code}

A \AgdaInductiveConstructor{server} constructor introduces a channel of type
$\OfCourse A$ given a continuation process that consumes a channel of type $A$
and a proof $\mathit{un}$ that every other channel in $\ContextD$ is
unrestricted.\Luca{Introdurre terminologia e dire che unrestricted vuol dire che
il canale pu√≤ essere ``duplicato'' e scartato.}

\begin{code}%
%
\>[3]\AgdaInductiveConstructor{client}%
\>[13]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{‚àÄ\{}\AgdaBound{Œì}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSpace{}%
\AgdaBound{A}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{p}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚âÉ}}\AgdaSpace{}%
\AgdaInductiveConstructor{¬ø}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{,}}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{Process}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{Process}\AgdaSpace{}%
\AgdaBound{Œì}\<%
\\
%
\>[3]\AgdaInductiveConstructor{weaken}%
\>[13]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{‚àÄ\{}\AgdaBound{Œì}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSpace{}%
\AgdaBound{A}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{p}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚âÉ}}\AgdaSpace{}%
\AgdaInductiveConstructor{¬ø}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{,}}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{Process}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{Process}\AgdaSpace{}%
\AgdaBound{Œì}\<%
\\
%
\>[3]\AgdaInductiveConstructor{contract}%
\>[13]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{‚àÄ\{}\AgdaBound{Œì}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSpace{}%
\AgdaBound{A}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{p}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚âÉ}}\AgdaSpace{}%
\AgdaInductiveConstructor{¬ø}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{,}}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{Process}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{¬ø}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaInductiveConstructor{¬ø}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{Process}\AgdaSpace{}%
\AgdaBound{Œì}\<%
\end{code}

The constructors \AgdaInductiveConstructor{client},
\AgdaInductiveConstructor{weaken} and \AgdaInductiveConstructor{contract}
introduce a channel of type $\WhyNot A$ and follow the same pattern of the
previous process forms. Note that, in the case of
\AgdaInductiveConstructor{contract}, the contraction of $\WhyNot A$ applies to
the first two channels in the typing context of the continuation. This is
consistent with the fact that \Calculus uses an explicit prefix
$\Contract\x\y\z$ that models contraction and binds $y$ and $z$ in the
continuation process. In a pen-and-paper presentation, like the one by
Wadler~\citep{Wadler14}, it is arguably more convenient to have weaking and
contraction typing rules without the corresponding process forms.

\begin{code}%
%
\>[3]\AgdaInductiveConstructor{cut}%
\>[13]\AgdaSymbol{:}%
\>[1721I]\AgdaSymbol{‚àÄ\{}\AgdaBound{Œì}\AgdaSpace{}%
\AgdaBound{Œì‚ÇÅ}\AgdaSpace{}%
\AgdaBound{Œì‚ÇÇ}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{B}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{d}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Dual}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{B}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{p}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚âÉ}}\AgdaSpace{}%
\AgdaBound{Œì‚ÇÅ}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{+}}\AgdaSpace{}%
\AgdaBound{Œì‚ÇÇ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\<%
\\
\>[.][@{}l@{}]\<[1721I]%
\>[15]\AgdaDatatype{Process}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaBound{Œì‚ÇÅ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{Process}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaBound{Œì‚ÇÇ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{Process}\AgdaSpace{}%
\AgdaBound{Œì}\<%
\end{code}

A \AgdaInductiveConstructor{cut} process incorporates a duality proof for the
peer endpoints of the channel being restricted and a splitting proof that
distributes the free channels among the two parallel processes.

\end{AgdaAlign}

\begin{code}%
\>[0]\AgdaFunction{\#process}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{‚àÄ\{}\AgdaBound{Œì}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{\#}}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{Process}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{Process}\AgdaSpace{}%
\AgdaBound{Œî}\<%
\end{code}
\begin{code}[hide]%
\>[0]\AgdaFunction{\#process}\AgdaSpace{}%
\AgdaBound{œÄ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{link}\AgdaSpace{}%
\AgdaBound{d}\AgdaSpace{}%
\AgdaBound{p}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaKeyword{with}\AgdaSpace{}%
\AgdaFunction{\#one+}\AgdaSpace{}%
\AgdaBound{œÄ}\AgdaSpace{}%
\AgdaBound{p}\<%
\\
\>[0]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaBound{Œî‚Ä≤}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{œÄ‚Ä≤}\AgdaSpace{}%
\AgdaKeyword{with}\AgdaSpace{}%
\AgdaFunction{\#singleton-inv}\AgdaSpace{}%
\AgdaBound{œÄ‚Ä≤}\<%
\\
\>[0]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{link}\AgdaSpace{}%
\AgdaBound{d}\AgdaSpace{}%
\AgdaBound{q}\<%
\\
\>[0]\AgdaFunction{\#process}\AgdaSpace{}%
\AgdaBound{œÄ}\AgdaSpace{}%
\AgdaInductiveConstructor{close}\AgdaSpace{}%
\AgdaKeyword{with}\AgdaSpace{}%
\AgdaFunction{\#singleton-inv}\AgdaSpace{}%
\AgdaBound{œÄ}\<%
\\
\>[0]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{close}\<%
\\
\>[0]\AgdaFunction{\#process}\AgdaSpace{}%
\AgdaBound{œÄ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{fail}\AgdaSpace{}%
\AgdaBound{p}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaKeyword{with}\AgdaSpace{}%
\AgdaFunction{\#one+}\AgdaSpace{}%
\AgdaBound{œÄ}\AgdaSpace{}%
\AgdaBound{p}\<%
\\
\>[0]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaBound{Œî‚Ä≤}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{œÄ‚Ä≤}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{fail}\AgdaSpace{}%
\AgdaBound{q}\<%
\\
\>[0]\AgdaFunction{\#process}\AgdaSpace{}%
\AgdaBound{œÄ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{wait}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{P}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaKeyword{with}\AgdaSpace{}%
\AgdaFunction{\#one+}\AgdaSpace{}%
\AgdaBound{œÄ}\AgdaSpace{}%
\AgdaBound{p}\<%
\\
\>[0]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaBound{Œî‚Ä≤}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{œÄ‚Ä≤}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{wait}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{\#process}\AgdaSpace{}%
\AgdaBound{œÄ‚Ä≤}\AgdaSpace{}%
\AgdaBound{P}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{\#process}\AgdaSpace{}%
\AgdaBound{œÄ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{select}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{P}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaKeyword{with}\AgdaSpace{}%
\AgdaFunction{\#one+}\AgdaSpace{}%
\AgdaBound{œÄ}\AgdaSpace{}%
\AgdaBound{p}\<%
\\
\>[0]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaBound{Œî‚Ä≤}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{œÄ‚Ä≤}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{select}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{\#process}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{\#next}\AgdaSpace{}%
\AgdaBound{œÄ‚Ä≤}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{P}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{\#process}\AgdaSpace{}%
\AgdaBound{œÄ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{case}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{P}\AgdaSpace{}%
\AgdaBound{Q}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaKeyword{with}\AgdaSpace{}%
\AgdaFunction{\#one+}\AgdaSpace{}%
\AgdaBound{œÄ}\AgdaSpace{}%
\AgdaBound{p}\<%
\\
\>[0]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaBound{Œî‚Ä≤}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{œÄ‚Ä≤}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{case}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{\#process}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{\#next}\AgdaSpace{}%
\AgdaBound{œÄ‚Ä≤}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{P}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{\#process}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{\#next}\AgdaSpace{}%
\AgdaBound{œÄ‚Ä≤}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{Q}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{\#process}\AgdaSpace{}%
\AgdaBound{œÄ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{fork}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaBound{P}\AgdaSpace{}%
\AgdaBound{Q}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaKeyword{with}\AgdaSpace{}%
\AgdaFunction{\#one+}\AgdaSpace{}%
\AgdaBound{œÄ}\AgdaSpace{}%
\AgdaBound{p}\<%
\\
\>[0]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaBound{Œî‚Ä≤}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{p‚Ä≤}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{œÄ‚Ä≤}\AgdaSpace{}%
\AgdaKeyword{with}\AgdaSpace{}%
\AgdaFunction{\#split}\AgdaSpace{}%
\AgdaBound{œÄ‚Ä≤}\AgdaSpace{}%
\AgdaBound{q}\<%
\\
\>[0]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaBound{Œî‚ÇÅ}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{Œî‚ÇÇ}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{q‚Ä≤}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{œÄ‚ÇÅ}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{œÄ‚ÇÇ}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{fork}\AgdaSpace{}%
\AgdaBound{p‚Ä≤}\AgdaSpace{}%
\AgdaBound{q‚Ä≤}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{\#process}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{\#next}\AgdaSpace{}%
\AgdaBound{œÄ‚ÇÅ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{P}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{\#process}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{\#next}\AgdaSpace{}%
\AgdaBound{œÄ‚ÇÇ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{Q}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{\#process}\AgdaSpace{}%
\AgdaBound{œÄ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{join}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{P}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaKeyword{with}\AgdaSpace{}%
\AgdaFunction{\#one+}\AgdaSpace{}%
\AgdaBound{œÄ}\AgdaSpace{}%
\AgdaBound{p}\<%
\\
\>[0]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaBound{Œî‚Ä≤}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{œÄ‚Ä≤}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{join}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{\#process}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{\#next}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{\#next}\AgdaSpace{}%
\AgdaBound{œÄ‚Ä≤}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaBound{P}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{\#process}\AgdaSpace{}%
\AgdaBound{œÄ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{cut}\AgdaSpace{}%
\AgdaBound{d}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{P}\AgdaSpace{}%
\AgdaBound{Q}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaKeyword{with}\AgdaSpace{}%
\AgdaFunction{\#split}\AgdaSpace{}%
\AgdaBound{œÄ}\AgdaSpace{}%
\AgdaBound{p}\<%
\\
\>[0]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaBound{Œî‚ÇÅ}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{Œî‚ÇÇ}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{œÄ‚ÇÅ}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{œÄ‚ÇÇ}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{cut}\AgdaSpace{}%
\AgdaBound{d}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{\#process}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{\#next}\AgdaSpace{}%
\AgdaBound{œÄ‚ÇÅ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{P}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{\#process}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{\#next}\AgdaSpace{}%
\AgdaBound{œÄ‚ÇÇ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{Q}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{\#process}\AgdaSpace{}%
\AgdaBound{œÄ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{server}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{un}\AgdaSpace{}%
\AgdaBound{P}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaKeyword{with}\AgdaSpace{}%
\AgdaFunction{\#one+}\AgdaSpace{}%
\AgdaBound{œÄ}\AgdaSpace{}%
\AgdaBound{p}\<%
\\
\>[0]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaBound{Œî‚Ä≤}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{œÄ‚Ä≤}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{server}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{\#un}\AgdaSpace{}%
\AgdaBound{œÄ‚Ä≤}\AgdaSpace{}%
\AgdaBound{un}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{\#process}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{\#next}\AgdaSpace{}%
\AgdaBound{œÄ‚Ä≤}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{P}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{\#process}\AgdaSpace{}%
\AgdaBound{œÄ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{client}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{P}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaKeyword{with}\AgdaSpace{}%
\AgdaFunction{\#one+}\AgdaSpace{}%
\AgdaBound{œÄ}\AgdaSpace{}%
\AgdaBound{p}\<%
\\
\>[0]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaBound{Œî‚Ä≤}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{œÄ‚Ä≤}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{client}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{\#process}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{\#next}\AgdaSpace{}%
\AgdaBound{œÄ‚Ä≤}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{P}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{\#process}\AgdaSpace{}%
\AgdaBound{œÄ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{weaken}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{P}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaKeyword{with}\AgdaSpace{}%
\AgdaFunction{\#one+}\AgdaSpace{}%
\AgdaBound{œÄ}\AgdaSpace{}%
\AgdaBound{p}\<%
\\
\>[0]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaBound{Œî‚Ä≤}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{œÄ‚Ä≤}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{weaken}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{\#process}\AgdaSpace{}%
\AgdaBound{œÄ‚Ä≤}\AgdaSpace{}%
\AgdaBound{P}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{\#process}\AgdaSpace{}%
\AgdaBound{œÄ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{contract}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{P}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaKeyword{with}\AgdaSpace{}%
\AgdaFunction{\#one+}\AgdaSpace{}%
\AgdaBound{œÄ}\AgdaSpace{}%
\AgdaBound{p}\<%
\\
\>[0]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaBound{Œî‚Ä≤}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{œÄ‚Ä≤}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{contract}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{\#process}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{\#next}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{\#next}\AgdaSpace{}%
\AgdaBound{œÄ‚Ä≤}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaBound{P}\AgdaSymbol{)}\<%
\end{code}

\subsection{Operational Semantics}
\label{sec:semantics-agda}

We formalize structural precongruence as a binary relation between processes
that are well typed in the \emph{same} typing context. This entails that
structural precongruence preserves typing by definition.

\begin{AgdaAlign}
\begin{code}%
\>[0]\AgdaKeyword{data}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{\AgdaUnderscore{}‚äí\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{‚àÄ\{}\AgdaBound{Œì}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{Process}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{Process}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaPrimitive{Set}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\end{code}

The datatype for $\pcong$ has one constructor for each of the structural
precongruence rules in \Cref{tab:semantics}. Since many aspects recur
repeatedly, we will focus on just a few representative rules starting from
\SComm.

\begin{code}%
\>[0][@{}l@{\AgdaIndent{1}}]%
\>[2]\AgdaInductiveConstructor{s-comm}\AgdaSpace{}%
\AgdaSymbol{:}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaSymbol{‚àÄ\{}\AgdaBound{Œì}\AgdaSpace{}%
\AgdaBound{Œì‚ÇÅ}\AgdaSpace{}%
\AgdaBound{Œì‚ÇÇ}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaBound{P}\AgdaSpace{}%
\AgdaBound{Q}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{d}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Dual}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{B}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{p}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚âÉ}}\AgdaSpace{}%
\AgdaBound{Œì‚ÇÅ}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{+}}\AgdaSpace{}%
\AgdaBound{Œì‚ÇÇ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\<%
\\
%
\>[4]\AgdaInductiveConstructor{cut}\AgdaSpace{}%
\AgdaBound{d}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{P}\AgdaSpace{}%
\AgdaBound{Q}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚äí}}\AgdaSpace{}%
\AgdaInductiveConstructor{cut}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{dual-symm}\AgdaSpace{}%
\AgdaBound{d}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{+-comm}\AgdaSpace{}%
\AgdaBound{p}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{Q}\AgdaSpace{}%
\AgdaBound{P}\<%
\end{code}

The constructor \AgdaInductiveConstructor{s-comm} models the commutativity
property of parallel composition. We use \AgdaFunction{dual-symm} and
\AgdaFunction{+-comm} to compute the proofs of the relation
$\AgdaDatatype{Dual}~B~A$ and of the splitting $\ContextC \simeq \Context_2 +
\Context_1$ from $d$ and $p$ respectively.

\begin{code}[hide]%
%
\>[2]\AgdaInductiveConstructor{s-link}\AgdaSpace{}%
\AgdaSymbol{:}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaSymbol{‚àÄ\{}\AgdaBound{Œì}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{B}\AgdaSymbol{\}}\<%
\\
%
\>[4]\AgdaSymbol{(}\AgdaBound{d}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Dual}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{B}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{p}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚âÉ}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{[}}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{]}}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{+}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{[}}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{]}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\<%
\\
%
\>[4]\AgdaInductiveConstructor{link}\AgdaSpace{}%
\AgdaBound{d}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚äí}}\AgdaSpace{}%
\AgdaInductiveConstructor{link}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{dual-symm}\AgdaSpace{}%
\AgdaBound{d}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{+-comm}\AgdaSpace{}%
\AgdaBound{p}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaInductiveConstructor{s-fail}\AgdaSpace{}%
\AgdaSymbol{:}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaSymbol{‚àÄ\{}\AgdaBound{Œì}\AgdaSpace{}%
\AgdaBound{Œì‚ÇÅ}\AgdaSpace{}%
\AgdaBound{Œì‚ÇÇ}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaBound{P}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{d}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Dual}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{B}\AgdaSymbol{)}\<%
\\
%
\>[4]\AgdaSymbol{(}\AgdaBound{p}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚âÉ}}\AgdaSpace{}%
\AgdaBound{Œì‚ÇÅ}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{+}}\AgdaSpace{}%
\AgdaBound{Œì‚ÇÇ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{q}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{Œì‚ÇÅ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚âÉ}}\AgdaSpace{}%
\AgdaInductiveConstructor{‚ä§}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{,}}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\<%
\\
%
\>[4]\AgdaKeyword{let}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{q‚Ä≤}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{+-assoc-l}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaKeyword{in}\<%
\\
%
\>[4]\AgdaInductiveConstructor{cut}\AgdaSpace{}%
\AgdaBound{d}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{fail}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{split-r}\AgdaSpace{}%
\AgdaBound{q}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaBound{P}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚äí}}\AgdaSpace{}%
\AgdaInductiveConstructor{fail}\AgdaSpace{}%
\AgdaBound{q‚Ä≤}\<%
\end{code}

The constructor \AgdaInductiveConstructor{s-wait} models the \SWait rule:

\begin{code}%
%
\>[2]\AgdaInductiveConstructor{s-wait}\AgdaSpace{}%
\AgdaSymbol{:}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaSymbol{‚àÄ\{}\AgdaBound{Œì}\AgdaSpace{}%
\AgdaBound{Œì‚ÇÅ}\AgdaSpace{}%
\AgdaBound{Œì‚ÇÇ}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{B}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{P}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Process}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSymbol{)\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{Q}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Process}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaBound{Œì‚ÇÇ}\AgdaSymbol{)\}}\<%
\\
%
\>[4]\AgdaSymbol{(}\AgdaBound{d}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Dual}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{B}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{p}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚âÉ}}\AgdaSpace{}%
\AgdaBound{Œì‚ÇÅ}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{+}}\AgdaSpace{}%
\AgdaBound{Œì‚ÇÇ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{q}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{Œì‚ÇÅ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚âÉ}}\AgdaSpace{}%
\AgdaInductiveConstructor{‚ä•}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{,}}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\<%
\\
%
\>[4]\AgdaKeyword{let}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{p‚Ä≤}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{q‚Ä≤}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{+-assoc-l}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaKeyword{in}\<%
\\
%
\>[4]\AgdaInductiveConstructor{cut}\AgdaSpace{}%
\AgdaBound{d}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{wait}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{split-r}\AgdaSpace{}%
\AgdaBound{q}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{P}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{Q}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚äí}}\AgdaSpace{}%
\AgdaInductiveConstructor{wait}\AgdaSpace{}%
\AgdaBound{q‚Ä≤}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{cut}\AgdaSpace{}%
\AgdaBound{d}\AgdaSpace{}%
\AgdaBound{p‚Ä≤}\AgdaSpace{}%
\AgdaBound{P}\AgdaSpace{}%
\AgdaBound{Q}\AgdaSymbol{)}\<%
\end{code}

There are two non-trivial aspects worth commenting. The first one concerns the
proof $(\AgdaInductiveConstructor{split-r}~q)$ used in the
\AgdaInductiveConstructor{wait} process before structural precongruence is
applied. To understand the meaning of this proof, we must recall three key
elements:
\begin{enumerate}
  \item
    $(\AgdaInductiveConstructor{wait}~(\AgdaInductiveConstructor{split-r}~q)~P)$
    is a direct sub-process of the \AgdaInductiveConstructor{cut}, and therefore
    it is meant to be well typed in the context
    $A~\AgdaInductiveConstructor{‚à∑}~\Context_1$.
  \item Being a \AgdaInductiveConstructor{wait} process, such context must
    contain a $\Bot$ type as per the typing rule \WaitRule. That is
    $A~\AgdaInductiveConstructor{‚à∑}~\Context_1 \simeq [\Bot] +
    A~\AgdaInductiveConstructor{‚à∑}~\Delta$ for some $\Delta$.
  \item The \SWait rule is applicable only provided that the channel restricted
    by the cut (say $x$, of type $A$) is different from the channel (say $y$, of
    type $\Bot$) consumed by the \AgdaInductiveConstructor{wait} process.
    %
    We enforce the side condition $x \ne y$ of \SWait imposing that the type $A$
    in front of $A~\AgdaInductiveConstructor{‚à∑}~\Context_1$ necessarily comes
    from the right component of the splitting $[\Bot] +
    A~\AgdaInductiveConstructor{‚à∑}~\Delta$ through the use of
    \AgdaInductiveConstructor{split-r}.
\end{enumerate}

The other aspect that is worth commenting concerns the rearrangement of the
splittings in the process after the application of structural precongruence.
Overall, $p$ and $q$ prove the splittings $([\Bot] + \ContextD) + \ContextC_2$,
but the precongruence rule requires this splitting to be rearranged as $[\Bot] +
(\ContextD + \ContextC_2)$. That is, we need to apply the left-to-right
associativity property of context splitting which we called
\AgdaFunction{+-assoc-l} in \Cref{sec:context-agda}. The nested
\AgdaKeyword{let}-\AgdaKeyword{in} allows us to pattern match the result of the
application $\AgdaFunction{+-assoc-l}~p~q$ and to extract the new proofs $p'$
and $q'$ for the rearranged splittings.

The constructors \AgdaInductiveConstructor{s-select-l} and
\AgdaInductiveConstructor{s-select-r} model \SSelect when the selected tag is
respectively \AgdaInductiveConstructor{true} and
\AgdaInductiveConstructor{false}.

\begin{code}%
%
\>[2]\AgdaInductiveConstructor{s-select-l}\AgdaSpace{}%
\AgdaSymbol{:}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaSymbol{‚àÄ\{}\AgdaBound{Œì}\AgdaSpace{}%
\AgdaBound{Œì‚ÇÅ}\AgdaSpace{}%
\AgdaBound{Œì‚ÇÇ}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaBound{C}\AgdaSpace{}%
\AgdaBound{D}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{P}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Process}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{C}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSymbol{)\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{Q}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Process}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaBound{Œì‚ÇÇ}\AgdaSymbol{)\}}\<%
\\
%
\>[4]\AgdaSymbol{(}\AgdaBound{d}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Dual}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{B}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{p}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚âÉ}}\AgdaSpace{}%
\AgdaBound{Œì‚ÇÅ}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{+}}\AgdaSpace{}%
\AgdaBound{Œì‚ÇÇ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{q}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{Œì‚ÇÅ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚âÉ}}\AgdaSpace{}%
\AgdaBound{C}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚äï}}\AgdaSpace{}%
\AgdaBound{D}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{,}}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\<%
\\
%
\>[4]\AgdaKeyword{let}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{p‚Ä≤}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{q‚Ä≤}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{+-assoc-l}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaKeyword{in}\<%
\\
%
\>[4]\AgdaInductiveConstructor{cut}\AgdaSpace{}%
\AgdaBound{d}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{select}\AgdaSpace{}%
\AgdaInductiveConstructor{true}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{split-r}\AgdaSpace{}%
\AgdaBound{q}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{P}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{Q}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚äí}}\<%
\\
%
\>[4]\AgdaInductiveConstructor{select}\AgdaSpace{}%
\AgdaInductiveConstructor{true}\AgdaSpace{}%
\AgdaBound{q‚Ä≤}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{cut}\AgdaSpace{}%
\AgdaBound{d}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{split-l}\AgdaSpace{}%
\AgdaBound{p‚Ä≤}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{\#process}\AgdaSpace{}%
\AgdaInductiveConstructor{\#here}\AgdaSpace{}%
\AgdaBound{P}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{Q}\AgdaSymbol{)}\<%
\end{code}

Here the process
$(\AgdaInductiveConstructor{select}~\AgdaInductiveConstructor{true}~(\AgdaInductiveConstructor{split-r}~q)~P)$,
which is found under a cut for $x : A$, is using some channel $y : C \Plus D$ to
send the tag $\AgdaInductiveConstructor{true}$.
%
Unlike \AgdaInductiveConstructor{wait}, which consumes the channel it operates
on, the continuation process $P$ will be using a fresh continuation channel $z :
C$. Therefore, $P$ is required to be well typed in the context
$C~\AgdaInductiveConstructor{‚à∑}~A~\AgdaInductiveConstructor{‚à∑}~\ContextD$, where
the type of the continuation sits on top of the type of the restricted channel.
%
After structural precongruence is applied, however, the type $C$ of the
continuation channel $z$ ends up underneath that of the restricted channel $x$,
because now the two channels are introduced in the opposite order. Therefore, we
are in a situation where we need to turn $P$ into a process that is well typed
in the context
$A~\AgdaInductiveConstructor{‚à∑}~C~\AgdaInductiveConstructor{‚à∑}~\ContextD$. This
is achieved applying the function \AgdaFunction{\#process} to the
\AgdaInductiveConstructor{\#here} permutation, which swaps the two topmost types
in a typing context, and finally to the process $P$.

\begin{code}[hide]%
%
\>[2]\AgdaInductiveConstructor{s-select-r}\AgdaSpace{}%
\AgdaSymbol{:}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaSymbol{‚àÄ\{}\AgdaBound{Œì}\AgdaSpace{}%
\AgdaBound{Œì‚ÇÅ}\AgdaSpace{}%
\AgdaBound{Œì‚ÇÇ}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaBound{C}\AgdaSpace{}%
\AgdaBound{D}\AgdaSymbol{\}}\<%
\\
%
\>[4]\AgdaSymbol{\{}\AgdaBound{P}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Process}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{D}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSymbol{)\}}\<%
\\
%
\>[4]\AgdaSymbol{\{}\AgdaBound{Q}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Process}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaBound{Œì‚ÇÇ}\AgdaSymbol{)\}}\<%
\\
%
\>[4]\AgdaSymbol{(}\AgdaBound{d}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Dual}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{B}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{p}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚âÉ}}\AgdaSpace{}%
\AgdaBound{Œì‚ÇÅ}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{+}}\AgdaSpace{}%
\AgdaBound{Œì‚ÇÇ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{q}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{Œì‚ÇÅ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚âÉ}}\AgdaSpace{}%
\AgdaBound{C}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚äï}}\AgdaSpace{}%
\AgdaBound{D}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{,}}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\<%
\\
%
\>[4]\AgdaKeyword{let}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{p‚Ä≤}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{q‚Ä≤}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{+-assoc-l}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaKeyword{in}\<%
\\
%
\>[4]\AgdaInductiveConstructor{cut}\AgdaSpace{}%
\AgdaBound{d}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{select}\AgdaSpace{}%
\AgdaInductiveConstructor{false}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{split-r}\AgdaSpace{}%
\AgdaBound{q}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{P}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{Q}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚äí}}\<%
\\
%
\>[4]\AgdaInductiveConstructor{select}\AgdaSpace{}%
\AgdaInductiveConstructor{false}\AgdaSpace{}%
\AgdaBound{q‚Ä≤}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{cut}\AgdaSpace{}%
\AgdaBound{d}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{split-l}\AgdaSpace{}%
\AgdaBound{p‚Ä≤}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{\#process}\AgdaSpace{}%
\AgdaInductiveConstructor{\#here}\AgdaSpace{}%
\AgdaBound{P}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{Q}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaInductiveConstructor{s-case}\AgdaSpace{}%
\AgdaSymbol{:}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaSymbol{‚àÄ\{}\AgdaBound{Œì}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaBound{A‚ÇÅ}\AgdaSpace{}%
\AgdaBound{A‚ÇÇ}\AgdaSpace{}%
\AgdaBound{Œì‚ÇÅ}\AgdaSpace{}%
\AgdaBound{Œì‚ÇÇ}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSymbol{\}}\<%
\\
%
\>[4]\AgdaSymbol{\{}\AgdaBound{P}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Process}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{A‚ÇÅ}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSymbol{)\}}\<%
\\
%
\>[4]\AgdaSymbol{\{}\AgdaBound{Q}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Process}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{A‚ÇÇ}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSymbol{)\}}\<%
\\
%
\>[4]\AgdaSymbol{\{}\AgdaBound{R}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Process}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaBound{Œì‚ÇÇ}\AgdaSymbol{)\}}\<%
\\
%
\>[4]\AgdaSymbol{(}\AgdaBound{d}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Dual}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{B}\AgdaSymbol{)}\<%
\\
%
\>[4]\AgdaSymbol{(}\AgdaBound{p}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚âÉ}}\AgdaSpace{}%
\AgdaBound{Œì‚ÇÅ}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{+}}\AgdaSpace{}%
\AgdaBound{Œì‚ÇÇ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{q}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{Œì‚ÇÅ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚âÉ}}\AgdaSpace{}%
\AgdaBound{A‚ÇÅ}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{\&}}\AgdaSpace{}%
\AgdaBound{A‚ÇÇ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{,}}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\<%
\\
%
\>[4]\AgdaKeyword{let}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{p‚Ä≤}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{q‚Ä≤}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{+-assoc-l}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaKeyword{in}\<%
\\
%
\>[4]\AgdaInductiveConstructor{cut}\AgdaSpace{}%
\AgdaBound{d}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{case}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{split-r}\AgdaSpace{}%
\AgdaBound{q}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{P}\AgdaSpace{}%
\AgdaBound{Q}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{R}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚äí}}\<%
\\
%
\>[4]\AgdaInductiveConstructor{case}\AgdaSpace{}%
\AgdaBound{q‚Ä≤}%
\>[2451I]\AgdaSymbol{(}\AgdaInductiveConstructor{cut}\AgdaSpace{}%
\AgdaBound{d}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{split-l}\AgdaSpace{}%
\AgdaBound{p‚Ä≤}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{\#process}\AgdaSpace{}%
\AgdaInductiveConstructor{\#here}\AgdaSpace{}%
\AgdaBound{P}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{R}\AgdaSymbol{)}\<%
\\
\>[.][@{}l@{}]\<[2451I]%
\>[12]\AgdaSymbol{(}\AgdaInductiveConstructor{cut}\AgdaSpace{}%
\AgdaBound{d}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{split-l}\AgdaSpace{}%
\AgdaBound{p‚Ä≤}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{\#process}\AgdaSpace{}%
\AgdaInductiveConstructor{\#here}\AgdaSpace{}%
\AgdaBound{Q}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{R}\AgdaSymbol{)}\<%
\end{code}

\emph{En passant}, we also show the modeling of the \SForkL rule, which is
interesting because of its complex side conditions:

\begin{code}%
%
\>[2]\AgdaInductiveConstructor{s-fork-l}\AgdaSpace{}%
\AgdaSymbol{:}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaSymbol{‚àÄ\{}\AgdaBound{Œì}\AgdaSpace{}%
\AgdaBound{Œì‚ÇÅ}\AgdaSpace{}%
\AgdaBound{Œì‚ÇÇ}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSpace{}%
\AgdaBound{Œî‚ÇÅ}\AgdaSpace{}%
\AgdaBound{Œî‚ÇÇ}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaBound{C}\AgdaSpace{}%
\AgdaBound{D}\AgdaSymbol{\}}\<%
\\
%
\>[4]\AgdaSymbol{\{}\AgdaBound{P}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Process}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{C}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaBound{Œî‚ÇÅ}\AgdaSymbol{)\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{Q}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Process}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{D}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaBound{Œî‚ÇÇ}\AgdaSymbol{)\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{R}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Process}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaBound{Œì‚ÇÇ}\AgdaSymbol{)\}}\<%
\\
%
\>[4]\AgdaSymbol{(}\AgdaBound{d}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Dual}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{B}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{p}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚âÉ}}\AgdaSpace{}%
\AgdaBound{Œì‚ÇÅ}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{+}}\AgdaSpace{}%
\AgdaBound{Œì‚ÇÇ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{q}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{Œì‚ÇÅ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚âÉ}}\AgdaSpace{}%
\AgdaBound{C}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚äó}}\AgdaSpace{}%
\AgdaBound{D}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{,}}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚âÉ}}\AgdaSpace{}%
\AgdaBound{Œî‚ÇÅ}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{+}}\AgdaSpace{}%
\AgdaBound{Œî‚ÇÇ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\<%
\\
%
\>[4]\AgdaKeyword{let}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{p‚Ä≤}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{q‚Ä≤}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{+-assoc-l}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaKeyword{in}\<%
\\
%
\>[4]\AgdaKeyword{let}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{p‚Ä≤‚Ä≤}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{r‚Ä≤}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{+-assoc-l}\AgdaSpace{}%
\AgdaBound{p‚Ä≤}\AgdaSpace{}%
\AgdaBound{r}\AgdaSpace{}%
\AgdaKeyword{in}\<%
\\
%
\>[4]\AgdaKeyword{let}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{q‚Ä≤‚Ä≤}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{r‚Ä≤‚Ä≤}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{+-assoc-r}\AgdaSpace{}%
\AgdaBound{r‚Ä≤}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{+-comm}\AgdaSpace{}%
\AgdaBound{p‚Ä≤‚Ä≤}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaKeyword{in}\<%
\\
%
\>[4]\AgdaInductiveConstructor{cut}\AgdaSpace{}%
\AgdaBound{d}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{fork}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{split-r}\AgdaSpace{}%
\AgdaBound{q}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{split-l}\AgdaSpace{}%
\AgdaBound{r}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{P}\AgdaSpace{}%
\AgdaBound{Q}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{R}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚äí}}\<%
\\
%
\>[4]\AgdaInductiveConstructor{fork}\AgdaSpace{}%
\AgdaBound{q‚Ä≤}\AgdaSpace{}%
\AgdaBound{r‚Ä≤‚Ä≤}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{cut}\AgdaSpace{}%
\AgdaBound{d}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{split-l}\AgdaSpace{}%
\AgdaBound{q‚Ä≤‚Ä≤}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{\#process}\AgdaSpace{}%
\AgdaInductiveConstructor{\#here}\AgdaSpace{}%
\AgdaBound{P}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{R}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{Q}\<%
\end{code}

Recall from \Cref{tab:semantics} that we want to apply this rule on a process of
the form $\Cut\x{\Fork\y\u\v{P}{Q}}{R}$ when $x \in \fn{P}$. We capture this
condition by means of the splitting $(\AgdaInductiveConstructor{split-l}~r)$,
meaning that the type $A$ of $x$ ends up in the typing context for $P$ and not
in the one for $Q$.
%
The symmetric rule \SForkR is modeled by another constructor
\AgdaInductiveConstructor{s-fork-r}, which is not shown here but is similar to
\AgdaInductiveConstructor{s-fork-l} except that
$(\AgdaInductiveConstructor{split-l}~r)$ is replaced by
$(\AgdaInductiveConstructor{split-r}~r)$.

\begin{code}[hide]%
%
\>[2]\AgdaInductiveConstructor{s-fork-r}\AgdaSpace{}%
\AgdaSymbol{:}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaSymbol{‚àÄ\{}\AgdaBound{Œì}\AgdaSpace{}%
\AgdaBound{Œì‚ÇÅ}\AgdaSpace{}%
\AgdaBound{Œì‚ÇÇ}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSpace{}%
\AgdaBound{Œî‚ÇÅ}\AgdaSpace{}%
\AgdaBound{Œî‚ÇÇ}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaBound{C}\AgdaSpace{}%
\AgdaBound{D}\AgdaSymbol{\}}\<%
\\
%
\>[4]\AgdaSymbol{\{}\AgdaBound{P}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Process}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{C}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaBound{Œî‚ÇÅ}\AgdaSymbol{)\}}\<%
\\
%
\>[4]\AgdaSymbol{\{}\AgdaBound{Q}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Process}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{D}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaBound{Œî‚ÇÇ}\AgdaSymbol{)\}}\<%
\\
%
\>[4]\AgdaSymbol{\{}\AgdaBound{R}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Process}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaBound{Œì‚ÇÇ}\AgdaSymbol{)\}}\<%
\\
%
\>[4]\AgdaSymbol{(}\AgdaBound{d}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Dual}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{B}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{p}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚âÉ}}\AgdaSpace{}%
\AgdaBound{Œì‚ÇÅ}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{+}}\AgdaSpace{}%
\AgdaBound{Œì‚ÇÇ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{q}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{Œì‚ÇÅ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚âÉ}}\AgdaSpace{}%
\AgdaBound{C}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚äó}}\AgdaSpace{}%
\AgdaBound{D}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{,}}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSymbol{)}\<%
\\
%
\>[4]\AgdaSymbol{(}\AgdaBound{r}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚âÉ}}\AgdaSpace{}%
\AgdaBound{Œî‚ÇÅ}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{+}}\AgdaSpace{}%
\AgdaBound{Œî‚ÇÇ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\<%
\\
%
\>[4]\AgdaKeyword{let}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{p‚Ä≤}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{q‚Ä≤}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{+-assoc-l}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaKeyword{in}\<%
\\
%
\>[4]\AgdaKeyword{let}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{p‚Ä≤‚Ä≤}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{r‚Ä≤}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{+-assoc-l}\AgdaSpace{}%
\AgdaBound{p‚Ä≤}\AgdaSpace{}%
\AgdaBound{r}\AgdaSpace{}%
\AgdaKeyword{in}\<%
\\
%
\>[4]\AgdaInductiveConstructor{cut}\AgdaSpace{}%
\AgdaBound{d}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{fork}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{split-r}\AgdaSpace{}%
\AgdaBound{q}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{split-r}\AgdaSpace{}%
\AgdaBound{r}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{P}\AgdaSpace{}%
\AgdaBound{Q}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{R}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚äí}}\<%
\\
%
\>[4]\AgdaInductiveConstructor{fork}\AgdaSpace{}%
\AgdaBound{q‚Ä≤}\AgdaSpace{}%
\AgdaBound{r‚Ä≤}\AgdaSpace{}%
\AgdaBound{P}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{cut}\AgdaSpace{}%
\AgdaBound{d}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{split-l}\AgdaSpace{}%
\AgdaBound{p‚Ä≤‚Ä≤}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{\#process}\AgdaSpace{}%
\AgdaInductiveConstructor{\#here}\AgdaSpace{}%
\AgdaBound{Q}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{R}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaInductiveConstructor{s-join}\AgdaSpace{}%
\AgdaSymbol{:}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaSymbol{‚àÄ\{}\AgdaBound{Œì}\AgdaSpace{}%
\AgdaBound{Œì‚ÇÅ}\AgdaSpace{}%
\AgdaBound{Œì‚ÇÇ}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaBound{C}\AgdaSpace{}%
\AgdaBound{D}\AgdaSymbol{\}}\<%
\\
%
\>[4]\AgdaSymbol{\{}\AgdaBound{P}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Process}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{D}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaBound{C}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSymbol{)\}}\<%
\\
%
\>[4]\AgdaSymbol{\{}\AgdaBound{Q}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Process}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaBound{Œì‚ÇÇ}\AgdaSymbol{)\}}\<%
\\
%
\>[4]\AgdaSymbol{(}\AgdaBound{d}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Dual}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{B}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{p}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚âÉ}}\AgdaSpace{}%
\AgdaBound{Œì‚ÇÅ}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{+}}\AgdaSpace{}%
\AgdaBound{Œì‚ÇÇ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{q}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{Œì‚ÇÅ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚âÉ}}\AgdaSpace{}%
\AgdaBound{C}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚Öã}}\AgdaSpace{}%
\AgdaBound{D}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{,}}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\<%
\\
%
\>[4]\AgdaKeyword{let}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{p‚Ä≤}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{q‚Ä≤}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{+-assoc-l}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaKeyword{in}\<%
\\
%
\>[4]\AgdaInductiveConstructor{cut}\AgdaSpace{}%
\AgdaBound{d}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{join}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{split-r}\AgdaSpace{}%
\AgdaBound{q}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{P}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{Q}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚äí}}\<%
\\
%
\>[4]\AgdaInductiveConstructor{join}\AgdaSpace{}%
\AgdaBound{q‚Ä≤}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{cut}\AgdaSpace{}%
\AgdaBound{d}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{split-l}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{split-l}\AgdaSpace{}%
\AgdaBound{p‚Ä≤}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{\#process}\AgdaSpace{}%
\AgdaFunction{\#rot}\AgdaSpace{}%
\AgdaBound{P}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{Q}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaInductiveConstructor{s-server}\AgdaSpace{}%
\AgdaSymbol{:}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaSymbol{‚àÄ\{}\AgdaBound{Œì}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaBound{C}\AgdaSpace{}%
\AgdaBound{Œì‚ÇÅ}\AgdaSpace{}%
\AgdaBound{Œì‚ÇÇ}\AgdaSpace{}%
\AgdaBound{Œî‚ÇÅ}\AgdaSymbol{\}}\<%
\\
%
\>[4]\AgdaSymbol{\{}\AgdaBound{P}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Process}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{C}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaInductiveConstructor{¬ø}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaBound{Œî‚ÇÅ}\AgdaSymbol{)\}}\<%
\\
%
\>[4]\AgdaSymbol{\{}\AgdaBound{Q}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Process}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaBound{Œì‚ÇÇ}\AgdaSymbol{)\}}\<%
\\
%
\>[4]\AgdaSymbol{(}\AgdaBound{d}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Dual}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{B}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{p}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚âÉ}}\AgdaSpace{}%
\AgdaBound{Œì‚ÇÅ}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{+}}\AgdaSpace{}%
\AgdaBound{Œì‚ÇÇ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{q}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{Œì‚ÇÅ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚âÉ}}\AgdaSpace{}%
\AgdaInductiveConstructor{¬°}\AgdaSpace{}%
\AgdaBound{C}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{,}}\AgdaSpace{}%
\AgdaBound{Œî‚ÇÅ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{Œì‚ÇÇ}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚âÉ}}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{+}}\AgdaSpace{}%
\AgdaBound{Œì‚ÇÇ}\AgdaSymbol{)}\<%
\\
%
\>[4]\AgdaSymbol{(}\AgdaBound{un‚ÇÅ}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Un}\AgdaSpace{}%
\AgdaBound{Œî‚ÇÅ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{un‚ÇÇ}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Un}\AgdaSpace{}%
\AgdaBound{Œì‚ÇÇ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\<%
\\
%
\>[4]\AgdaKeyword{let}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{p‚Ä≤}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{q‚Ä≤}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{+-assoc-l}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaKeyword{in}\<%
\\
%
\>[4]\AgdaInductiveConstructor{cut}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{d-?-!}\AgdaSpace{}%
\AgdaBound{d}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{server}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{split-r}\AgdaSpace{}%
\AgdaBound{q}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{un-‚à∑}\AgdaSpace{}%
\AgdaBound{un‚ÇÅ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{P}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{server}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{split-l}\AgdaSpace{}%
\AgdaBound{r}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{un‚ÇÇ}\AgdaSpace{}%
\AgdaBound{Q}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚äí}}\<%
\\
%
\>[4]\AgdaInductiveConstructor{server}\AgdaSpace{}%
\AgdaBound{q‚Ä≤}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{\#un+}\AgdaSpace{}%
\AgdaBound{p‚Ä≤}\AgdaSpace{}%
\AgdaBound{un‚ÇÅ}\AgdaSpace{}%
\AgdaBound{un‚ÇÇ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{cut}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{d-?-!}\AgdaSpace{}%
\AgdaBound{d}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{split-l}\AgdaSpace{}%
\AgdaBound{p‚Ä≤}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{\#process}\AgdaSpace{}%
\AgdaInductiveConstructor{\#here}\AgdaSpace{}%
\AgdaBound{P}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{server}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{split-l}\AgdaSpace{}%
\AgdaBound{r}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{un‚ÇÇ}\AgdaSpace{}%
\AgdaBound{Q}\AgdaSymbol{))}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaInductiveConstructor{s-client}\AgdaSpace{}%
\AgdaSymbol{:}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaSymbol{‚àÄ\{}\AgdaBound{Œì}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaBound{C}\AgdaSpace{}%
\AgdaBound{Œì‚ÇÅ}\AgdaSpace{}%
\AgdaBound{Œì‚ÇÇ}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSymbol{\}}\<%
\\
%
\>[4]\AgdaSymbol{\{}\AgdaBound{P}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Process}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{C}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSymbol{)\}}\<%
\\
%
\>[4]\AgdaSymbol{\{}\AgdaBound{Q}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Process}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaBound{Œì‚ÇÇ}\AgdaSymbol{)\}}\<%
\\
%
\>[4]\AgdaSymbol{(}\AgdaBound{d}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Dual}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{B}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{p}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚âÉ}}\AgdaSpace{}%
\AgdaBound{Œì‚ÇÅ}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{+}}\AgdaSpace{}%
\AgdaBound{Œì‚ÇÇ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{q}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{Œì‚ÇÅ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚âÉ}}\AgdaSpace{}%
\AgdaInductiveConstructor{¬ø}\AgdaSpace{}%
\AgdaBound{C}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{,}}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\<%
\\
%
\>[4]\AgdaKeyword{let}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{p‚Ä≤}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{q‚Ä≤}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{+-assoc-l}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaKeyword{in}\<%
\\
%
\>[4]\AgdaInductiveConstructor{cut}\AgdaSpace{}%
\AgdaBound{d}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{client}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{split-r}\AgdaSpace{}%
\AgdaBound{q}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{P}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{Q}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚äí}}\<%
\\
%
\>[4]\AgdaInductiveConstructor{client}\AgdaSpace{}%
\AgdaBound{q‚Ä≤}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{cut}\AgdaSpace{}%
\AgdaBound{d}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{split-l}\AgdaSpace{}%
\AgdaBound{p‚Ä≤}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{\#process}\AgdaSpace{}%
\AgdaInductiveConstructor{\#here}\AgdaSpace{}%
\AgdaBound{P}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{Q}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaInductiveConstructor{s-weaken}\AgdaSpace{}%
\AgdaSymbol{:}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaSymbol{‚àÄ\{}\AgdaBound{Œì}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaBound{C}\AgdaSpace{}%
\AgdaBound{Œì‚ÇÅ}\AgdaSpace{}%
\AgdaBound{Œì‚ÇÇ}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSymbol{\}}\<%
\\
%
\>[4]\AgdaSymbol{\{}\AgdaBound{P}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Process}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSymbol{)\}}\<%
\\
%
\>[4]\AgdaSymbol{\{}\AgdaBound{Q}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Process}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaBound{Œì‚ÇÇ}\AgdaSymbol{)\}}\<%
\\
%
\>[4]\AgdaSymbol{(}\AgdaBound{d}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Dual}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{B}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{p}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚âÉ}}\AgdaSpace{}%
\AgdaBound{Œì‚ÇÅ}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{+}}\AgdaSpace{}%
\AgdaBound{Œì‚ÇÇ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{q}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{Œì‚ÇÅ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚âÉ}}\AgdaSpace{}%
\AgdaInductiveConstructor{¬ø}\AgdaSpace{}%
\AgdaBound{C}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{,}}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\<%
\\
%
\>[4]\AgdaKeyword{let}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{p‚Ä≤}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{q‚Ä≤}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{+-assoc-l}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaKeyword{in}\<%
\\
%
\>[4]\AgdaInductiveConstructor{cut}\AgdaSpace{}%
\AgdaBound{d}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{weaken}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{split-r}\AgdaSpace{}%
\AgdaBound{q}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{P}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{Q}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚äí}}\<%
\\
%
\>[4]\AgdaInductiveConstructor{weaken}\AgdaSpace{}%
\AgdaBound{q‚Ä≤}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{cut}\AgdaSpace{}%
\AgdaBound{d}\AgdaSpace{}%
\AgdaBound{p‚Ä≤}\AgdaSpace{}%
\AgdaBound{P}\AgdaSpace{}%
\AgdaBound{Q}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaInductiveConstructor{s-contract}\AgdaSpace{}%
\AgdaSymbol{:}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaSymbol{‚àÄ\{}\AgdaBound{Œì}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaBound{C}\AgdaSpace{}%
\AgdaBound{Œì‚ÇÅ}\AgdaSpace{}%
\AgdaBound{Œì‚ÇÇ}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSymbol{\}}\<%
\\
%
\>[4]\AgdaSymbol{\{}\AgdaBound{P}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Process}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{¬ø}\AgdaSpace{}%
\AgdaBound{C}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaInductiveConstructor{¬ø}\AgdaSpace{}%
\AgdaBound{C}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSymbol{)\}}\<%
\\
%
\>[4]\AgdaSymbol{\{}\AgdaBound{Q}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Process}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaBound{Œì‚ÇÇ}\AgdaSymbol{)\}}\<%
\\
%
\>[4]\AgdaSymbol{(}\AgdaBound{d}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Dual}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{B}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{p}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚âÉ}}\AgdaSpace{}%
\AgdaBound{Œì‚ÇÅ}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{+}}\AgdaSpace{}%
\AgdaBound{Œì‚ÇÇ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{q}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{Œì‚ÇÅ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚âÉ}}\AgdaSpace{}%
\AgdaInductiveConstructor{¬ø}\AgdaSpace{}%
\AgdaBound{C}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{,}}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\<%
\\
%
\>[4]\AgdaKeyword{let}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{p‚Ä≤}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{q‚Ä≤}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{+-assoc-l}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaKeyword{in}\<%
\\
%
\>[4]\AgdaInductiveConstructor{cut}\AgdaSpace{}%
\AgdaBound{d}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{contract}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{split-r}\AgdaSpace{}%
\AgdaBound{q}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{P}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{Q}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚äí}}\<%
\\
%
\>[4]\AgdaInductiveConstructor{contract}\AgdaSpace{}%
\AgdaBound{q‚Ä≤}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{cut}\AgdaSpace{}%
\AgdaBound{d}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{split-l}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{split-l}\AgdaSpace{}%
\AgdaBound{p‚Ä≤}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{\#process}\AgdaSpace{}%
\AgdaFunction{\#rot}\AgdaSpace{}%
\AgdaBound{P}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{Q}\AgdaSymbol{)}\<%
\end{code}

Finally, in \Cref{sec:semantics} we have colloquially defined $\pcong$ as a
``\emph{pre-congruence}'', implicitly implying that it is reflexive, transitive,
and that it is is preserved by some forms of calculus. In the formalization we
have to be precise and we introduce specific rules:

\begin{code}%
%
\>[2]\AgdaInductiveConstructor{s-refl}%
\>[10]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{‚àÄ\{}\AgdaBound{Œì}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{P}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Process}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaBound{P}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚äí}}\AgdaSpace{}%
\AgdaBound{P}\<%
\\
%
\>[2]\AgdaInductiveConstructor{s-tran}%
\>[10]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{‚àÄ\{}\AgdaBound{Œì}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{P}\AgdaSpace{}%
\AgdaBound{Q}\AgdaSpace{}%
\AgdaBound{R}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Process}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaBound{P}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚äí}}\AgdaSpace{}%
\AgdaBound{Q}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaBound{Q}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚äí}}\AgdaSpace{}%
\AgdaBound{R}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaBound{P}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚äí}}\AgdaSpace{}%
\AgdaBound{R}\<%
\\
%
\>[2]\AgdaInductiveConstructor{s-cong}%
\>[10]\AgdaSymbol{:}%
\>[3066I]\AgdaSymbol{‚àÄ\{}\AgdaBound{Œì}\AgdaSpace{}%
\AgdaBound{Œì‚ÇÅ}\AgdaSpace{}%
\AgdaBound{Œì‚ÇÇ}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{A‚Ä≤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{P}\AgdaSpace{}%
\AgdaBound{Q}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Process}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaBound{Œì‚ÇÅ}\AgdaSymbol{)\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{P‚Ä≤}\AgdaSpace{}%
\AgdaBound{Q‚Ä≤}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Process}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{A‚Ä≤}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaBound{Œì‚ÇÇ}\AgdaSymbol{)\}}\<%
\\
\>[.][@{}l@{}]\<[3066I]%
\>[12]\AgdaSymbol{(}\AgdaBound{d}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Dual}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{A‚Ä≤}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{p}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚âÉ}}\AgdaSpace{}%
\AgdaBound{Œì‚ÇÅ}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{+}}\AgdaSpace{}%
\AgdaBound{Œì‚ÇÇ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaBound{P}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚äí}}\AgdaSpace{}%
\AgdaBound{Q}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaBound{P‚Ä≤}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚äí}}\AgdaSpace{}%
\AgdaBound{Q‚Ä≤}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\<%
\\
%
\>[12]\AgdaInductiveConstructor{cut}\AgdaSpace{}%
\AgdaBound{d}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{P}\AgdaSpace{}%
\AgdaBound{P‚Ä≤}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚äí}}\AgdaSpace{}%
\AgdaInductiveConstructor{cut}\AgdaSpace{}%
\AgdaBound{d}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{Q}\AgdaSpace{}%
\AgdaBound{Q‚Ä≤}\<%
\end{code}

Note that we define a single congruence rule \AgdaInductiveConstructor{s-cong}
that allows us to apply $\pcong$ within cuts, but not underneath prefixes. This
limited form of pre-congruence turns out to be sufficient for the development
that follows.
\end{AgdaAlign}
