


rec mult_func : [ âŠ¢ â€¢ Î±â‚ Î±â‚‚ Î±] â†’ [ âŠ¢ â€¢ Î±â‚ Î±â‚‚ Î±'] â†’ [ âŠ¢ mult_eq Î± Î±'] =
  / total /
  fn m1, m2 â‡’ case m1 of
  | [ âŠ¢ â€¢/00] â‡’ let [ âŠ¢ â€¢/00] = m2 in [ âŠ¢ mult/refl]
  | [ âŠ¢ â€¢/10] â‡’ let [ âŠ¢ â€¢/10] = m2 in [ âŠ¢ mult/refl]
  | [ âŠ¢ â€¢/01] â‡’ let [ âŠ¢ â€¢/01] = m2 in [ âŠ¢ mult/refl]
  ;


rec mult_id : [ âŠ¢ â€¢ Î±â‚ Î±â‚‚ Î±] â†’ [ âŠ¢ ident Î±â‚] â†’ [ âŠ¢ mult_eq Î±â‚‚ Î±] =
  / total /
  fn m, u â‡’
  let [ âŠ¢ ident/0] = u in
  case m of
  | [ âŠ¢ â€¢/00] â‡’ [ âŠ¢ mult/refl]
  | [ âŠ¢ â€¢/01] â‡’ [ âŠ¢ mult/refl]
  ;

LF get_uâˆ™ : mult â†’ type =
| get-uâˆ™ : ident Î² â†’ â€¢ Î² Î± Î± â†’ get_uâˆ™ Î±;

rec mult_get_id : {Î±:[ âŠ¢ mult]} [ âŠ¢ get_uâˆ™ Î±] =
  / total /
  mlam Î± â‡’ case [ âŠ¢ Î±] of
  | [ âŠ¢ ğŸ˜] â‡’ [ âŠ¢ get-uâˆ™ ident/0 â€¢/00]
  | [ âŠ¢ ğŸ™] â‡’ [ âŠ¢ get-uâˆ™ ident/0 â€¢/01]
  ;


rec mult_zsfree : [ âŠ¢ â€¢ Î±â‚ Î±â‚‚ Î±] â†’ [ âŠ¢ ident Î±] â†’ [ âŠ¢ mult_eq Î±â‚ Î±] =
  / total /
  fn m, u â‡’
  let [ âŠ¢ ident/0] = u in
  let [ âŠ¢ â€¢/00] = m in
  [ âŠ¢ mult/refl]
  ;


rec mult_comm : [ âŠ¢ â€¢ Î±â‚ Î±â‚‚ Î±] â†’ [ âŠ¢ â€¢ Î±â‚‚ Î±â‚ Î±] =
  / total /
  fn m â‡’ case m of
  | [ âŠ¢ â€¢/00] â‡’ [ âŠ¢ â€¢/00]
  | [ âŠ¢ â€¢/10] â‡’ [ âŠ¢ â€¢/01]
  | [ âŠ¢ â€¢/01] â‡’ [ âŠ¢ â€¢/10]
  ;


LF â€¢assoc : â€¢ _ _ _ â†’ â€¢ _ _ _ â†’ type =
  â€¢/assoc : â€¢ Î±â‚‚ Î±â‚ƒ Î±â‚‚â‚ƒ â†’ â€¢ Î±â‚ Î±â‚‚â‚ƒ Î± â†’ {M1:â€¢ Î±â‚ Î±â‚‚ Î±â‚â‚‚} {M2:â€¢ Î±â‚â‚‚ Î±â‚ƒ Î±} â€¢assoc M1 M2;

rec mult_assoc : {M1:[ âŠ¢ â€¢ Î±â‚ Î±â‚‚ Î±â‚â‚‚]} {M2:[ âŠ¢ â€¢ Î±â‚â‚‚ Î±â‚ƒ Î±]} [ âŠ¢ â€¢assoc M1 M2] =
  / total 2 /
  mlam M1, M2 â‡’ case [ âŠ¢ M2] of
  | [ âŠ¢ â€¢/00] â‡’ let [ âŠ¢ â€¢/00] = [ âŠ¢ M1] in [ âŠ¢ â€¢/assoc â€¢/00 â€¢/00 M1 M2]
  | [ âŠ¢ â€¢/01] â‡’ let [ âŠ¢ â€¢/00] = [ âŠ¢ M1] in [ âŠ¢ â€¢/assoc â€¢/01 â€¢/01 M1 M2]
  | [ âŠ¢ â€¢/10] â‡’ case [ âŠ¢ M1] of
    | [ âŠ¢ â€¢/10] â‡’ [ âŠ¢ â€¢/assoc â€¢/00 â€¢/10 M1 M2]
    | [ âŠ¢ â€¢/01] â‡’ [ âŠ¢ â€¢/assoc â€¢/10 â€¢/01 M1 M2]
  ;


rec mult_canc : [ âŠ¢ â€¢ Î±â‚ Î±â‚‚ Î±] â†’ [ âŠ¢ â€¢ Î±â‚ Î±â‚‚' Î±] â†’ [ âŠ¢ mult_eq Î±â‚‚ Î±â‚‚'] =
  / total /
  fn m1, m2 â‡’ case m1 of
  | [ âŠ¢ â€¢/00] â‡’ let [ âŠ¢ â€¢/00] = m2 in [ âŠ¢ mult/refl]
  | [ âŠ¢ â€¢/10] â‡’ let [ âŠ¢ â€¢/10] = m2 in [ âŠ¢ mult/refl]
  | [ âŠ¢ â€¢/01] â‡’ let [ âŠ¢ â€¢/01] = m2 in [ âŠ¢ mult/refl]
  ;


rec mult_id_cor : [ âŠ¢ â€¢ ğŸ˜ Î±â‚‚ Î±] â†’ [ âŠ¢ mult_eq Î±â‚‚ Î±] =
  / total /
  fn m â‡’ mult_id m [ âŠ¢ ident/0]
  ;

rec mult_zsfree_cor : [ âŠ¢ â€¢ Î±â‚ Î±â‚‚ ğŸ˜] â†’ [ âŠ¢ mult_eq Î±â‚ ğŸ˜] =
  / total /
  fn m â‡’ mult_zsfree m [ âŠ¢ ident/0]
  ;

rec mult_get_id_cor : {Î±:[ âŠ¢ mult]} [ âŠ¢ â€¢ ğŸ˜ Î± Î±] =
  / total /
  mlam Î± â‡’ let [ âŠ¢ get-uâˆ™ ident/0 M] = mult_get_id [ âŠ¢ Î±] in [ âŠ¢ M]
  ;



rec mult_hal_id : [ âŠ¢ hal Î±] â†’ [ âŠ¢ â€¢ Î± Î± Î±] =
  / total /
  fn u â‡’ let [ âŠ¢ hal/0] = u in [ âŠ¢ â€¢/00]
  ;

rec mult_ident_hal : [ âŠ¢ ident Î±] â†’ [ âŠ¢ hal Î±] =
  / total /
  fn u â‡’ let [ âŠ¢ ident/0] = u in [ âŠ¢ hal/0]
  ;

rec mult_hal_ident : [ âŠ¢ hal Î±] â†’ [ âŠ¢ ident Î±] =
  / total /
  fn u â‡’ let [ âŠ¢ hal/0] = u in [ âŠ¢ ident/0]
  ;
