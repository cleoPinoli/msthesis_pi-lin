\section{Examples}
\label{sec:examples}

\begin{code}[hide]
{-# OPTIONS --rewriting #-}
open import Data.Sum hiding (reduce; swap)
open import Data.Product using (_Ã—_; _,_; âˆƒ; âˆƒ-syntax)
open import Data.Nat using (â„•; zero; suc)
open import Data.Fin using (zero; suc; #_)
open import Data.List.Base using (List; []; _âˆ·_; [_]; _++_)
open import Function using (_$_)
open import Data.Maybe

open import Type
open import Context
open import Permutations
open import Process
open import DeadlockFreedom using (deadlock-freedom)
\end{code}

\begin{code}
ğ”¹ : Type
ğ”¹ = ğŸ™ âŠ• ğŸ™

True : Process [ ğ”¹ ]
True = left (< â‰«) close

False : Process [ ğ”¹ ]
False = right (< â‰«) close

Not : Process (dual ğ”¹ âˆ· ğ”¹ âˆ· [])
Not = case (< â‰«) (wait (< â‰«) False) (wait (< â‰«) True)

Copy : Process (dual ğ”¹ âˆ· ğ”¹ âˆ· [])
Copy = cut (< â‰«) (â†­process swap Not) Not

Drop : Process (dual ğ”¹ âˆ· ğŸ™ âˆ· [])
Drop = case (< â‰«) (wait (< â‰«) close) (wait (< â‰«) close)

And : Process (dual ğ”¹ âˆ· dual ğ”¹ âˆ· ğ”¹ âˆ· [])
And = case (< â‰«)
           (wait (< â‰«) Copy)
           (wait (< â‰«)
                 (cut (< â‰«)
                      (â†­process swap Drop)
                      (wait (< â‰«) False)))

Or : Process (dual ğ”¹ âˆ· dual ğ”¹ âˆ· ğ”¹ âˆ· [])
Or = cut (< < â‰«)
         (cut (> < â‰«)
              (â†­process swap Not)
              (cut (> > < â‰«)
                   (â†­process swap Not)
                   And))
         Not

ex1 : Process [ ğ”¹ ]
ex1 = cut â‰« False (cut â‰« False Or)

reduce : âˆ€{Î“} â†’ â„• â†’ Process Î“ â†’ Process Î“
reduce zero P = P
reduce (suc n) P with deadlock-freedom P
... | injâ‚ (Q , _ , _)  = Q
... | injâ‚‚ (Q , _)      = reduce n Q

_âŠ¸_ : âˆ€{n} â†’ PreType n â†’ PreType n â†’ PreType n
A âŠ¸ B = dual A â…‹ B

echo :  let X = var (# 0) in
        Process [ `! (`âˆ€ (X âŠ¸ X)) ]
echo =  server (< â‰«) un-[] $
        all (< â‰«) Î» X â†’
        join (< â‰«) $
        link (> < â‰«)

âŠ—-comm :  let X = var (# 1) in
          let Y = var (# 0) in
          Process [ `âˆ€ (`âˆ€ ((X âŠ— Y) âŠ¸ (Y âŠ— X))) ]
âŠ—-comm =  all (< â‰«) Î» X â†’
          all (< â‰«) Î» Y â†’
          join (< â‰«) $
          join (> < â‰«) $
          fork (> > < â‰«) (< â‰«)
               (link (< â‰«))
               (link (< â‰«))
\end{code}