\begin{code}[hide]%
\>[0]\AgdaSymbol{\{-\#}\AgdaSpace{}%
\AgdaKeyword{OPTIONS}\AgdaSpace{}%
\AgdaPragma{--rewriting}\AgdaSpace{}%
\AgdaSymbol{\#-\}}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Unit}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{tt}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Sum}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Product}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaInductiveConstructor{\AgdaUnderscore{},\AgdaUnderscore{}}}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.List.Base}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{[]}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{\AgdaUnderscore{}‚à∑\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{[\AgdaUnderscore{}]}}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Relation.Unary}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Type}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Context}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Permutations}\<%
\end{code}

\subsection{Process Representation}
\label{sec:process-agda}

We adopt an \emph{intrinsically-typed} representation of processes with
\emph{nameless} channels. The intrinsically-typed representation makes sure that
only well-typed processes can be constructed. This choice increases the effort
in the definition of the datatypes for representing processes and their
operational semantics, but pays off in the rest of the formalization for at
least three reasons:
\begin{itemize}
\item we need not give explicit names to channels, thus we avoid all the
  technicalities and pitfalls that a named representation entails;
\item we conflate processes and typing rules in the same datatype, thus reducing
  the overall number of datatypes defined in the formalization;
\item the typing preservation results are embedded in the very definition of the
  operational semantics of processes and need not require separate proofs
  (\Cref{sec:agda-semantics}).
\end{itemize}

Channels are not given any name. Instead, they are represented as terms
witnessing that their type is present in the typing context. This is known as
\emph{co-de Bruijn syntax}~\cite{McBride18}, according to which the typing
context associated with a term (a process, a channel) only contains the types of
the channels that actually occur within the term. For this reason, typing
contexts are split as soon as possible, according to the structure of processes,
to make sure that channels are appropriately (and above all linearly)
distributed among sub-processes, so that each channel occurs (and is used)
exactly once.\footnote{Strictly speaking, the typing context of a
\AgdaInductiveConstructor{fail} process may contain channels that do not occur
(and therefore are not used) by the process, but we consider this case as an
exception that does not alter in a substantial way the provided intuition
underlying the use of co-de Bruijn representation.}
%
Concretely, a channel of type $A$ is a predicate that holds for the singleton
context $\AgdaFunction[~A~\AgdaFunction]$:

\begin{code}%
\>[0]\AgdaKeyword{data}\AgdaSpace{}%
\AgdaDatatype{Ch}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{A}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Type}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Context}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaPrimitive{Set}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaInductiveConstructor{ch}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Ch}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{[}}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{]}}\<%
\end{code}

A process that is well typed in a typing context $\Context$ is a predicate that
holds for $\Context$. Here is the datatype \AgdaDatatype{Proc} for representing
processes:

\begin{code}%
\>[0]\AgdaKeyword{data}\AgdaSpace{}%
\AgdaDatatype{Proc}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Context}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaPrimitive{Set}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaInductiveConstructor{link}%
\>[12]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{‚àÄ\{}\AgdaBound{A}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaFunction{‚àÄ[}\AgdaSpace{}%
\AgdaDatatype{Ch}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚àó}}\AgdaSpace{}%
\AgdaDatatype{Ch}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{dual}\AgdaSpace{}%
\AgdaBound{A}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚áí}}\AgdaSpace{}%
\AgdaDatatype{Proc}\AgdaSpace{}%
\AgdaFunction{]}\<%
\\
%
\>[2]\AgdaInductiveConstructor{fail}%
\>[12]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{‚àÄ[}\AgdaSpace{}%
\AgdaDatatype{Ch}\AgdaSpace{}%
\AgdaInductiveConstructor{‚ä§}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚àó}}\AgdaSpace{}%
\AgdaFunction{U}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚áí}}\AgdaSpace{}%
\AgdaDatatype{Proc}\AgdaSpace{}%
\AgdaFunction{]}\<%
\\
%
\>[2]\AgdaInductiveConstructor{wait}%
\>[12]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{‚àÄ[}\AgdaSpace{}%
\AgdaDatatype{Ch}\AgdaSpace{}%
\AgdaInductiveConstructor{‚ä•}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚àó}}\AgdaSpace{}%
\AgdaDatatype{Proc}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚áí}}\AgdaSpace{}%
\AgdaDatatype{Proc}\AgdaSpace{}%
\AgdaFunction{]}\<%
\\
%
\>[2]\AgdaInductiveConstructor{close}%
\>[12]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{‚àÄ[}\AgdaSpace{}%
\AgdaDatatype{Ch}\AgdaSpace{}%
\AgdaInductiveConstructor{ùüô}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚áí}}\AgdaSpace{}%
\AgdaDatatype{Proc}\AgdaSpace{}%
\AgdaFunction{]}\<%
\\
%
\>[2]\AgdaInductiveConstructor{case}%
\>[12]\AgdaSymbol{:}%
\>[82I]\AgdaSymbol{‚àÄ\{}\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{B}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\<%
\\
\>[.][@{}l@{}]\<[82I]%
\>[14]\AgdaFunction{‚àÄ[}\AgdaSpace{}%
\AgdaDatatype{Ch}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{\&}}\AgdaSpace{}%
\AgdaBound{B}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚àó}}\AgdaSpace{}%
\AgdaSymbol{((}\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑\AgdaUnderscore{}}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚ä¢}}\AgdaSpace{}%
\AgdaDatatype{Proc}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚à©}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑\AgdaUnderscore{}}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚ä¢}}\AgdaSpace{}%
\AgdaDatatype{Proc}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚áí}}\AgdaSpace{}%
\AgdaDatatype{Proc}\AgdaSpace{}%
\AgdaFunction{]}\<%
\\
%
\>[2]\AgdaInductiveConstructor{select}%
\>[12]\AgdaSymbol{:}%
\>[102I]\AgdaSymbol{‚àÄ\{}\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{B}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\<%
\\
\>[.][@{}l@{}]\<[102I]%
\>[14]\AgdaFunction{‚àÄ[}\AgdaSpace{}%
\AgdaDatatype{Ch}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚äï}}\AgdaSpace{}%
\AgdaBound{B}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚àó}}\AgdaSpace{}%
\AgdaSymbol{((}\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑\AgdaUnderscore{}}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚ä¢}}\AgdaSpace{}%
\AgdaDatatype{Proc}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚à™}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑\AgdaUnderscore{}}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚ä¢}}\AgdaSpace{}%
\AgdaDatatype{Proc}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚áí}}\AgdaSpace{}%
\AgdaDatatype{Proc}\AgdaSpace{}%
\AgdaFunction{]}\<%
\\
%
\>[2]\AgdaInductiveConstructor{join}%
\>[12]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{‚àÄ\{}\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{B}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaFunction{‚àÄ[}\AgdaSpace{}%
\AgdaDatatype{Ch}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚Öã}}\AgdaSpace{}%
\AgdaBound{B}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚àó}}\AgdaSpace{}%
\AgdaSymbol{((}\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑\AgdaUnderscore{}}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚ä¢}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑\AgdaUnderscore{}}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚ä¢}}\AgdaSpace{}%
\AgdaDatatype{Proc}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚áí}}\AgdaSpace{}%
\AgdaDatatype{Proc}\AgdaSpace{}%
\AgdaFunction{]}\<%
\\
%
\>[2]\AgdaInductiveConstructor{fork}%
\>[12]\AgdaSymbol{:}%
\>[141I]\AgdaSymbol{‚àÄ\{}\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{B}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\<%
\\
\>[.][@{}l@{}]\<[141I]%
\>[14]\AgdaFunction{‚àÄ[}\AgdaSpace{}%
\AgdaDatatype{Ch}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚äó}}\AgdaSpace{}%
\AgdaBound{B}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚àó}}\AgdaSpace{}%
\AgdaSymbol{((}\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑\AgdaUnderscore{}}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚ä¢}}\AgdaSpace{}%
\AgdaDatatype{Proc}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚àó}}\AgdaSpace{}%
\AgdaSymbol{((}\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑\AgdaUnderscore{}}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚ä¢}}\AgdaSpace{}%
\AgdaDatatype{Proc}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚áí}}\AgdaSpace{}%
\AgdaDatatype{Proc}\AgdaSpace{}%
\AgdaFunction{]}\<%
\\
%
\>[2]\AgdaInductiveConstructor{all}%
\>[12]\AgdaSymbol{:}%
\>[161I]\AgdaSymbol{‚àÄ\{}\AgdaBound{A}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\<%
\\
\>[.][@{}l@{}]\<[161I]%
\>[14]\AgdaFunction{‚àÄ[}\AgdaSpace{}%
\AgdaDatatype{Ch}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{`‚àÄ}\AgdaSpace{}%
\AgdaBound{A}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚àó}}\AgdaSpace{}%
\AgdaFunction{‚ãÇ[}\AgdaSpace{}%
\AgdaBound{X}\AgdaSpace{}%
\AgdaFunction{‚à∂}\AgdaSpace{}%
\AgdaFunction{Type}\AgdaSpace{}%
\AgdaFunction{]}\AgdaSpace{}%
\AgdaSymbol{((}\AgdaFunction{subst}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{[}}\AgdaSpace{}%
\AgdaBound{X}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{/\AgdaUnderscore{}]}}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑\AgdaUnderscore{}}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚ä¢}}\AgdaSpace{}%
\AgdaDatatype{Proc}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚áí}}\AgdaSpace{}%
\AgdaDatatype{Proc}\AgdaSpace{}%
\AgdaFunction{]}\<%
\\
%
\>[2]\AgdaInductiveConstructor{ex}%
\>[12]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{‚àÄ\{}\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{B}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaFunction{‚àÄ[}\AgdaSpace{}%
\AgdaDatatype{Ch}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{`‚àÉ}\AgdaSpace{}%
\AgdaBound{A}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚àó}}\AgdaSpace{}%
\AgdaSymbol{((}\AgdaFunction{subst}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{[}}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{/\AgdaUnderscore{}]}}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑\AgdaUnderscore{}}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚ä¢}}\AgdaSpace{}%
\AgdaDatatype{Proc}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚áí}}\AgdaSpace{}%
\AgdaDatatype{Proc}\AgdaSpace{}%
\AgdaFunction{]}\<%
\\
%
\>[2]\AgdaInductiveConstructor{server}%
\>[12]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{‚àÄ\{}\AgdaBound{A}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaFunction{‚àÄ[}\AgdaSpace{}%
\AgdaDatatype{Ch}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{`!}\AgdaSpace{}%
\AgdaBound{A}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚àó}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{Un}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚à©}}\AgdaSpace{}%
\AgdaSymbol{((}\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑\AgdaUnderscore{}}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚ä¢}}\AgdaSpace{}%
\AgdaDatatype{Proc}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚áí}}\AgdaSpace{}%
\AgdaDatatype{Proc}\AgdaSpace{}%
\AgdaFunction{]}\<%
\\
%
\>[2]\AgdaInductiveConstructor{client}%
\>[12]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{‚àÄ\{}\AgdaBound{A}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaFunction{‚àÄ[}\AgdaSpace{}%
\AgdaDatatype{Ch}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{`?}\AgdaSpace{}%
\AgdaBound{A}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚àó}}\AgdaSpace{}%
\AgdaSymbol{((}\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑\AgdaUnderscore{}}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚ä¢}}\AgdaSpace{}%
\AgdaDatatype{Proc}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚áí}}\AgdaSpace{}%
\AgdaDatatype{Proc}\AgdaSpace{}%
\AgdaFunction{]}\<%
\\
%
\>[2]\AgdaInductiveConstructor{weaken}%
\>[12]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{‚àÄ\{}\AgdaBound{A}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaFunction{‚àÄ[}\AgdaSpace{}%
\AgdaDatatype{Ch}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{`?}\AgdaSpace{}%
\AgdaBound{A}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚àó}}\AgdaSpace{}%
\AgdaDatatype{Proc}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚áí}}\AgdaSpace{}%
\AgdaDatatype{Proc}\AgdaSpace{}%
\AgdaFunction{]}\<%
\\
%
\>[2]\AgdaInductiveConstructor{contract}%
\>[12]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{‚àÄ\{}\AgdaBound{A}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaFunction{‚àÄ[}\AgdaSpace{}%
\AgdaDatatype{Ch}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{`?}\AgdaSpace{}%
\AgdaBound{A}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚àó}}\AgdaSpace{}%
\AgdaSymbol{((}\AgdaInductiveConstructor{`?}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑\AgdaUnderscore{}}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚ä¢}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{`?}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑\AgdaUnderscore{}}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚ä¢}}\AgdaSpace{}%
\AgdaDatatype{Proc}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚áí}}\AgdaSpace{}%
\AgdaDatatype{Proc}\AgdaSpace{}%
\AgdaFunction{]}\<%
\\
%
\>[2]\AgdaInductiveConstructor{cut}%
\>[12]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{‚àÄ\{}\AgdaBound{A}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaFunction{‚àÄ[}\AgdaSpace{}%
\AgdaSymbol{((}\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑\AgdaUnderscore{}}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚ä¢}}\AgdaSpace{}%
\AgdaDatatype{Proc}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚àó}}\AgdaSpace{}%
\AgdaSymbol{((}\AgdaFunction{dual}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑\AgdaUnderscore{}}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚ä¢}}\AgdaSpace{}%
\AgdaDatatype{Proc}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚áí}}\AgdaSpace{}%
\AgdaDatatype{Proc}\AgdaSpace{}%
\AgdaFunction{]}\<%
\end{code}

All the constructors representing input/output actions, namely those from
\AgdaInductiveConstructor{fail} through \AgdaInductiveConstructor{contract},
basically follow the same pattern: they possibly quantify over some types $A$
and $B$ and then (implicitly) over a typing context $\Context$ through the
function \AgdaFunction{‚àÄ[\_]} applied to a predicate of the form
$P~\AgdaFunction{‚áí}~\AgdaDatatype{Proc}$. The predicate states how to build a
process that is well typed in $\Context$, provided that $\Context$ satisfies
$P$. In general, $P$ is a (separating) conjunction of sub-predicates
corresponding to the channel on which the process is acting and to the premises
of its typing rule.

The constructor \AgdaInductiveConstructor{fail} requires the context $\Context$
to satisfy the predicate
$\AgdaDatatype{Ch}~\AgdaInductiveConstructor{‚ä§}~\AgdaDatatype{‚àó}~\AgdaFunction{U}$,
meaning that $\Context$ must contain an entry \AgdaInductiveConstructor{‚ä§}. That
form of $\Context$ matches the one in the conclusion of \FailRule.

The constructor \AgdaInductiveConstructor{wait} corresponds to a process of the
form $\Wait\x.P$ and requires $\Context$ to (separately) satisfy
$\AgdaDatatype{Ch}~\AgdaInductiveConstructor{‚ä•}$, that is the channel $x$ on
which the process is operating, as well as \AgdaDatatype{Proc}, that is the
continuation process $P$, which must be well typed in the remaining typing
context.

The constructor \AgdaInductiveConstructor{close}, which corresponds to a process
of the form $\Close\x$, requires the typing context to be the singleton list
$[\One]$.

Crucially, the type of the continuation channels are \emph{prepended} to the
context that indexes the continuation processes using the
\AgdaInductiveConstructor{\_‚à∑\_} list constructor. This is consistent with the
fact that the continuation channels have been freshly introduced, and the
channel on which the process operates has been consumed.
%
There are just a few deviations from this pattern, which we discuss next.


The constructor \AgdaInductiveConstructor{fork}, which represents a process
$\Fork\x\y\z{P}{Q}$, has an additional splitting argument
$\Splitting\ContextD{\Context_1}{\Context_2}$ which distributes the resources in
$\ContextD$ among the two continuation processes $P$ and $Q$.

The constructor \AgdaInductiveConstructor{all}, which represents a process
$\Forall\x\X\y.P$, models the continuation $P$ using higher-order abstract
syntax (HOAS~\cite{}): the continuation $P$ is produced by a function applied to
a \AgdaInductiveConstructor{Type} $X$. Notice how the constructor enforces the
side condition of \ForallRule \emph{by definition}:
%
$A$ has type
$\AgdaDatatype{PreType}~(\AgdaInductiveConstructor{suc}~\AgdaInductiveConstructor{zero})$,
that is a pre-type with \emph{at most one} free type variable (that is $X$),
whereas $\ContextD$ is a list of $\AgdaDatatype{Type} =
\AgdaDatatype{PreType}~\AgdaInductiveConstructor{zero}$, that is a list of
pre-types without free type variables. Therefore, $X$ cannot occur in
$\ContextD$ as required by \ForallRule.

Finally, the constructor \AgdaInductiveConstructor{server}, which represents a
process $\Server\x\y.P$, has an additional argument of type
$\AgdaDatatype{Un}~\ContextD$ enforcing the property that $\ContextD$ is
unrestricted.

The two remaining constructors, \AgdaInductiveConstructor{link} and
\AgdaInductiveConstructor{cut}, deal with links and cuts in the expected way. A
link is well typed in a context
$\Splitting\Context{[A]}{[\AgdaFunction{dual}~A]}$. We use a splitting instead
of requiring $\Context$ to be $[A,\AgdaFunction{dual}~A]$ so that it becomes
straightforward to define \SLink using \AgdaFunction{+-comm}.
%
The constructor \AgdaInductiveConstructor{cut} models a process $\Cut\x{P}{Q}$
and uses splitting to distribute the resources in $\Context$ among $P$ and $Q$.

Permutations preserve process typeability. In a sense we can read this property
as the fact that we can rename channels at will.

\begin{code}%
\>[0]\AgdaFunction{‚Ü≠proc}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{‚àÄ\{}\AgdaBound{Œì}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚Ü≠}}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{Proc}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{Proc}\AgdaSpace{}%
\AgdaBound{Œî}\<%
\end{code}
\begin{code}[hide]%
\>[0]\AgdaFunction{‚Ü≠proc}\AgdaSpace{}%
\AgdaBound{œÄ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{link}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ch}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\AgdaSpace{}%
\AgdaInductiveConstructor{ch}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaKeyword{with}\AgdaSpace{}%
\AgdaFunction{‚Ü≠solo}\AgdaSpace{}%
\AgdaBound{œÄ}\AgdaSpace{}%
\AgdaBound{p}\<%
\\
\>[0]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{œÄ'}\AgdaSpace{}%
\AgdaKeyword{rewrite}\AgdaSpace{}%
\AgdaFunction{‚Ü≠solo-inv}\AgdaSpace{}%
\AgdaBound{œÄ'}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{link}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ch}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\AgdaSpace{}%
\AgdaInductiveConstructor{ch}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{‚Ü≠proc}\AgdaSpace{}%
\AgdaBound{œÄ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{fail}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ch}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\AgdaSpace{}%
\AgdaInductiveConstructor{tt}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaKeyword{with}\AgdaSpace{}%
\AgdaFunction{‚Ü≠solo}\AgdaSpace{}%
\AgdaBound{œÄ}\AgdaSpace{}%
\AgdaBound{p}\<%
\\
\>[0]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{œÄ'}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{fail}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ch}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\AgdaSpace{}%
\AgdaInductiveConstructor{tt}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{‚Ü≠proc}\AgdaSpace{}%
\AgdaBound{œÄ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{wait}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ch}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\AgdaSpace{}%
\AgdaBound{P}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaKeyword{with}\AgdaSpace{}%
\AgdaFunction{‚Ü≠solo}\AgdaSpace{}%
\AgdaBound{œÄ}\AgdaSpace{}%
\AgdaBound{p}\<%
\\
\>[0]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{œÄ'}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{wait}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ch}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\AgdaSpace{}%
\AgdaFunction{‚Ü≠proc}\AgdaSpace{}%
\AgdaBound{œÄ'}\AgdaSpace{}%
\AgdaBound{P}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{‚Ü≠proc}\AgdaSpace{}%
\AgdaBound{œÄ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{close}\AgdaSpace{}%
\AgdaInductiveConstructor{ch}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaKeyword{rewrite}\AgdaSpace{}%
\AgdaFunction{‚Ü≠solo-inv}\AgdaSpace{}%
\AgdaBound{œÄ}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{close}\AgdaSpace{}%
\AgdaInductiveConstructor{ch}\<%
\\
\>[0]\AgdaFunction{‚Ü≠proc}\AgdaSpace{}%
\AgdaBound{œÄ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{case}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ch}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{P}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{Q}\AgdaSymbol{)))}\AgdaSpace{}%
\AgdaKeyword{with}\AgdaSpace{}%
\AgdaFunction{‚Ü≠solo}\AgdaSpace{}%
\AgdaBound{œÄ}\AgdaSpace{}%
\AgdaBound{p}\<%
\\
\>[0]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{œÄ'}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{case}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ch}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{‚Ü≠proc}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{prep}\AgdaSpace{}%
\AgdaBound{œÄ'}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{P}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaFunction{‚Ü≠proc}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{prep}\AgdaSpace{}%
\AgdaBound{œÄ'}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{Q}\AgdaSymbol{))}\<%
\\
\>[0]\AgdaFunction{‚Ü≠proc}\AgdaSpace{}%
\AgdaBound{œÄ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{select}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ch}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\AgdaSpace{}%
\AgdaInductiveConstructor{inj‚ÇÅ}\AgdaSpace{}%
\AgdaBound{P}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaKeyword{with}\AgdaSpace{}%
\AgdaFunction{‚Ü≠solo}\AgdaSpace{}%
\AgdaBound{œÄ}\AgdaSpace{}%
\AgdaBound{p}\<%
\\
\>[0]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{œÄ'}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{select}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ch}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\AgdaSpace{}%
\AgdaInductiveConstructor{inj‚ÇÅ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{‚Ü≠proc}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{prep}\AgdaSpace{}%
\AgdaBound{œÄ'}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{P}\AgdaSymbol{))}\<%
\\
\>[0]\AgdaFunction{‚Ü≠proc}\AgdaSpace{}%
\AgdaBound{œÄ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{select}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ch}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\AgdaSpace{}%
\AgdaInductiveConstructor{inj‚ÇÇ}\AgdaSpace{}%
\AgdaBound{P}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaKeyword{with}\AgdaSpace{}%
\AgdaFunction{‚Ü≠solo}\AgdaSpace{}%
\AgdaBound{œÄ}\AgdaSpace{}%
\AgdaBound{p}\<%
\\
\>[0]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{œÄ'}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{select}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ch}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\AgdaSpace{}%
\AgdaInductiveConstructor{inj‚ÇÇ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{‚Ü≠proc}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{prep}\AgdaSpace{}%
\AgdaBound{œÄ'}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{P}\AgdaSymbol{))}\<%
\\
\>[0]\AgdaFunction{‚Ü≠proc}\AgdaSpace{}%
\AgdaBound{œÄ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{join}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ch}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\AgdaSpace{}%
\AgdaBound{P}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaKeyword{with}\AgdaSpace{}%
\AgdaFunction{‚Ü≠solo}\AgdaSpace{}%
\AgdaBound{œÄ}\AgdaSpace{}%
\AgdaBound{p}\<%
\\
\>[0]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{œÄ'}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{join}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ch}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\AgdaSpace{}%
\AgdaFunction{‚Ü≠proc}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{prep}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{prep}\AgdaSpace{}%
\AgdaBound{œÄ'}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaBound{P}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{‚Ü≠proc}\AgdaSpace{}%
\AgdaBound{œÄ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{fork}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ch}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{P}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\AgdaSpace{}%
\AgdaBound{Q}\AgdaSymbol{)))}\AgdaSpace{}%
\AgdaKeyword{with}\AgdaSpace{}%
\AgdaFunction{‚Ü≠solo}\AgdaSpace{}%
\AgdaBound{œÄ}\AgdaSpace{}%
\AgdaBound{p}\<%
\\
\>[0]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{p'}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{œÄ'}\AgdaSpace{}%
\AgdaKeyword{with}\AgdaSpace{}%
\AgdaFunction{‚Ü≠split}\AgdaSpace{}%
\AgdaBound{œÄ'}\AgdaSpace{}%
\AgdaBound{q}\<%
\\
\>[0]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaBound{Œî‚ÇÅ}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{Œî‚ÇÇ}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{q'}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{œÄ‚ÇÅ}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{œÄ‚ÇÇ}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{fork}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ch}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{p'}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{‚Ü≠proc}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{prep}\AgdaSpace{}%
\AgdaBound{œÄ‚ÇÅ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{P}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{q'}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\AgdaSpace{}%
\AgdaFunction{‚Ü≠proc}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{prep}\AgdaSpace{}%
\AgdaBound{œÄ‚ÇÇ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{Q}\AgdaSymbol{))}\<%
\\
\>[0]\AgdaFunction{‚Ü≠proc}\AgdaSpace{}%
\AgdaBound{œÄ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{all}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ch}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\AgdaSpace{}%
\AgdaBound{F}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaKeyword{with}\AgdaSpace{}%
\AgdaFunction{‚Ü≠solo}\AgdaSpace{}%
\AgdaBound{œÄ}\AgdaSpace{}%
\AgdaBound{p}\<%
\\
\>[0]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{œÄ'}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{all}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ch}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\AgdaSpace{}%
\AgdaSymbol{Œª}\AgdaSpace{}%
\AgdaBound{X}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaFunction{‚Ü≠proc}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{prep}\AgdaSpace{}%
\AgdaBound{œÄ'}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{F}\AgdaSpace{}%
\AgdaBound{X}\AgdaSymbol{))}\<%
\\
\>[0]\AgdaFunction{‚Ü≠proc}\AgdaSpace{}%
\AgdaBound{œÄ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ex}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ch}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\AgdaSpace{}%
\AgdaBound{P}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaKeyword{with}\AgdaSpace{}%
\AgdaFunction{‚Ü≠solo}\AgdaSpace{}%
\AgdaBound{œÄ}\AgdaSpace{}%
\AgdaBound{p}\<%
\\
\>[0]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{œÄ'}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{ex}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ch}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\AgdaSpace{}%
\AgdaFunction{‚Ü≠proc}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{prep}\AgdaSpace{}%
\AgdaBound{œÄ'}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{P}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{‚Ü≠proc}\AgdaSpace{}%
\AgdaBound{œÄ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{server}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ch}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{un}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{P}\AgdaSymbol{)))}\AgdaSpace{}%
\AgdaKeyword{with}\AgdaSpace{}%
\AgdaFunction{‚Ü≠solo}\AgdaSpace{}%
\AgdaBound{œÄ}\AgdaSpace{}%
\AgdaBound{p}\<%
\\
\>[0]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{œÄ'}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{server}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ch}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{‚Ü≠un}\AgdaSpace{}%
\AgdaBound{œÄ'}\AgdaSpace{}%
\AgdaBound{un}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaFunction{‚Ü≠proc}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{prep}\AgdaSpace{}%
\AgdaBound{œÄ'}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{P}\AgdaSymbol{))}\<%
\\
\>[0]\AgdaFunction{‚Ü≠proc}\AgdaSpace{}%
\AgdaBound{œÄ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{client}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ch}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\AgdaSpace{}%
\AgdaBound{P}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaKeyword{with}\AgdaSpace{}%
\AgdaFunction{‚Ü≠solo}\AgdaSpace{}%
\AgdaBound{œÄ}\AgdaSpace{}%
\AgdaBound{p}\<%
\\
\>[0]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{œÄ'}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{client}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ch}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\AgdaSpace{}%
\AgdaFunction{‚Ü≠proc}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{prep}\AgdaSpace{}%
\AgdaBound{œÄ'}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{P}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{‚Ü≠proc}\AgdaSpace{}%
\AgdaBound{œÄ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{weaken}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ch}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\AgdaSpace{}%
\AgdaBound{P}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaKeyword{with}\AgdaSpace{}%
\AgdaFunction{‚Ü≠solo}\AgdaSpace{}%
\AgdaBound{œÄ}\AgdaSpace{}%
\AgdaBound{p}\<%
\\
\>[0]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{œÄ'}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{weaken}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ch}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\AgdaSpace{}%
\AgdaFunction{‚Ü≠proc}\AgdaSpace{}%
\AgdaBound{œÄ'}\AgdaSpace{}%
\AgdaBound{P}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{‚Ü≠proc}\AgdaSpace{}%
\AgdaBound{œÄ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{contract}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ch}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\AgdaSpace{}%
\AgdaBound{P}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaKeyword{with}\AgdaSpace{}%
\AgdaFunction{‚Ü≠solo}\AgdaSpace{}%
\AgdaBound{œÄ}\AgdaSpace{}%
\AgdaBound{p}\<%
\\
\>[0]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{œÄ'}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{contract}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ch}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\AgdaSpace{}%
\AgdaFunction{‚Ü≠proc}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{prep}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{prep}\AgdaSpace{}%
\AgdaBound{œÄ'}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaBound{P}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{‚Ü≠proc}\AgdaSpace{}%
\AgdaBound{œÄ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{cut}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{P}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\AgdaSpace{}%
\AgdaBound{Q}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaKeyword{with}\AgdaSpace{}%
\AgdaFunction{‚Ü≠split}\AgdaSpace{}%
\AgdaBound{œÄ}\AgdaSpace{}%
\AgdaBound{p}\<%
\\
\>[0]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaBound{Œî‚ÇÅ}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{Œî‚ÇÇ}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{œÄ‚ÇÅ}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{œÄ‚ÇÇ}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{cut}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{‚Ü≠proc}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{prep}\AgdaSpace{}%
\AgdaBound{œÄ‚ÇÅ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{P}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\AgdaSpace{}%
\AgdaFunction{‚Ü≠proc}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{prep}\AgdaSpace{}%
\AgdaBound{œÄ‚ÇÇ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{Q}\AgdaSymbol{)}\<%
\end{code}
